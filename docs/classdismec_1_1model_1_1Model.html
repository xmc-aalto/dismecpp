<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.9.1"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>DiSMEC++: dismec::model::Model Class Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/x-mathjax-config">
  MathJax.Hub.Config({
    extensions: ["tex2jax.js"],
    jax: ["input/TeX","output/HTML-CSS"],
});
</script>
<script type="text/javascript" async="async" src="https://cdn.jsdelivr.net/npm/mathjax@2/MathJax.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">DiSMEC++
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.9.1 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
var searchBox = new SearchBox("searchBox", "search",false,'Search','.html');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */</script>
<div id="main-nav"></div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(document).ready(function(){initNavTree('classdismec_1_1model_1_1Model.html',''); initResizable(); });
/* @license-end */
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="header">
  <div class="summary">
<a href="#pub-types">Public Types</a> &#124;
<a href="#pub-methods">Public Member Functions</a> &#124;
<a href="#pro-methods">Protected Member Functions</a> &#124;
<a href="#pri-methods">Private Member Functions</a> &#124;
<a href="#pri-attribs">Private Attributes</a> &#124;
<a href="classdismec_1_1model_1_1Model-members.html">List of all members</a>  </div>
  <div class="headertitle">
<div class="title">dismec::model::Model Class Reference<span class="mlabels"><span class="mlabel">abstract</span></span></div>  </div>
</div><!--header-->
<div class="contents">

<p>A model combines a set of weight with some meta-information about these weights.  
 <a href="classdismec_1_1model_1_1Model.html#details">More...</a></p>

<p><code>#include &lt;<a class="el" href="model_8h_source.html">model.h</a>&gt;</code></p>
<div class="dynheader">
Inheritance diagram for dismec::model::Model:</div>
<div class="dyncontent">
 <div class="center">
  <img src="classdismec_1_1model_1_1Model.png" usemap="#dismec::model::Model_map" alt=""/>
  <map id="dismec::model::Model_map" name="dismec::model::Model_map">
<area href="classdismec_1_1model_1_1DenseModel.html" title="Implementation of the Model class that stores the weights as a single, dense matrix." alt="dismec::model::DenseModel" shape="rect" coords="0,56,233,80"/>
<area href="classdismec_1_1model_1_1SparseModel.html" alt="dismec::model::SparseModel" shape="rect" coords="243,56,476,80"/>
<area href="classdismec_1_1model_1_1SubModelWrapper.html" alt="dismec::model::SubModelWrapper&lt; T &gt;" shape="rect" coords="486,56,719,80"/>
  </map>
</div></div>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="pub-types"></a>
Public Types</h2></td></tr>
<tr class="memitem:a643e6cd1377ecd1bb8ea93a93a503c93"><td class="memItemLeft" align="right" valign="top">using&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classdismec_1_1model_1_1Model.html#a643e6cd1377ecd1bb8ea93a93a503c93">PredictionMatrixOut</a> = Eigen::Ref&lt; <a class="el" href="namespacedismec.html#aa5bb6a768e148994d5f74ba63aa756c8">PredictionMatrix</a> &gt;</td></tr>
<tr class="separator:a643e6cd1377ecd1bb8ea93a93a503c93"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a1483094f44801656fefdce6f22d04b64"><td class="memItemLeft" align="right" valign="top">using&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classdismec_1_1model_1_1Model.html#a1483094f44801656fefdce6f22d04b64">FeatureMatrixIn</a> = <a class="el" href="namespacedismec.html#ae37c14c95728812db1271c1ec0243017">GenericInMatrix</a></td></tr>
<tr class="separator:a1483094f44801656fefdce6f22d04b64"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a967fe576599e4401186bd34590ece765"><td class="memItemLeft" align="right" valign="top">using&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classdismec_1_1model_1_1Model.html#a967fe576599e4401186bd34590ece765">WeightVectorIn</a> = <a class="el" href="namespacedismec.html#ac5d82a0199ce34810c1ef57b38da5ca6">GenericInVector</a></td></tr>
<tr class="separator:a967fe576599e4401186bd34590ece765"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="pub-methods"></a>
Public Member Functions</h2></td></tr>
<tr class="memitem:a3337cf0970846a390509719867d17ae1"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classdismec_1_1model_1_1Model.html#a3337cf0970846a390509719867d17ae1">Model</a> (<a class="el" href="structdismec_1_1model_1_1PartialModelSpec.html">PartialModelSpec</a> spec)</td></tr>
<tr class="separator:a3337cf0970846a390509719867d17ae1"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa023fec6ec01b1417a5087dc591c85c9"><td class="memItemLeft" align="right" valign="top">virtual&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classdismec_1_1model_1_1Model.html#aa023fec6ec01b1417a5087dc591c85c9">~Model</a> ()=default</td></tr>
<tr class="separator:aa023fec6ec01b1417a5087dc591c85c9"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a47517b7d163661eb46404527944076c1"><td class="memItemLeft" align="right" valign="top">long&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classdismec_1_1model_1_1Model.html#a47517b7d163661eb46404527944076c1">num_labels</a> () const noexcept</td></tr>
<tr class="memdesc:a47517b7d163661eb46404527944076c1"><td class="mdescLeft">&#160;</td><td class="mdescRight">How many labels are in the underlying dataset.  <a href="classdismec_1_1model_1_1Model.html#a47517b7d163661eb46404527944076c1">More...</a><br /></td></tr>
<tr class="separator:a47517b7d163661eb46404527944076c1"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a31a7492ca66d9483bbe8eb723f186a9a"><td class="memItemLeft" align="right" valign="top">virtual long&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classdismec_1_1model_1_1Model.html#a31a7492ca66d9483bbe8eb723f186a9a">num_features</a> () const =0</td></tr>
<tr class="memdesc:a31a7492ca66d9483bbe8eb723f186a9a"><td class="mdescLeft">&#160;</td><td class="mdescRight">How many weights are in each weight vector, i.e. how many features should the input have.  <a href="classdismec_1_1model_1_1Model.html#a31a7492ca66d9483bbe8eb723f186a9a">More...</a><br /></td></tr>
<tr class="separator:a31a7492ca66d9483bbe8eb723f186a9a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a8e691012eaafde6dbcdc171bd21a3282"><td class="memItemLeft" align="right" valign="top">long&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classdismec_1_1model_1_1Model.html#a8e691012eaafde6dbcdc171bd21a3282">num_weights</a> () const noexcept</td></tr>
<tr class="memdesc:a8e691012eaafde6dbcdc171bd21a3282"><td class="mdescLeft">&#160;</td><td class="mdescRight">How many weights vectors are in this model.  <a href="classdismec_1_1model_1_1Model.html#a8e691012eaafde6dbcdc171bd21a3282">More...</a><br /></td></tr>
<tr class="separator:a8e691012eaafde6dbcdc171bd21a3282"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a7893db5f731a51d97c0144b6049e43df"><td class="memItemLeft" align="right" valign="top">virtual bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classdismec_1_1model_1_1Model.html#a7893db5f731a51d97c0144b6049e43df">has_sparse_weights</a> () const =0</td></tr>
<tr class="memdesc:a7893db5f731a51d97c0144b6049e43df"><td class="mdescLeft">&#160;</td><td class="mdescRight">whether this model stores the weights in a sparse format, or a dense format.  <a href="classdismec_1_1model_1_1Model.html#a7893db5f731a51d97c0144b6049e43df">More...</a><br /></td></tr>
<tr class="separator:a7893db5f731a51d97c0144b6049e43df"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a7e63006d06505dddb9d48264e6ca1fb9"><td class="memItemLeft" align="right" valign="top">bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classdismec_1_1model_1_1Model.html#a7e63006d06505dddb9d48264e6ca1fb9">is_partial_model</a> () const</td></tr>
<tr class="memdesc:a7e63006d06505dddb9d48264e6ca1fb9"><td class="mdescLeft">&#160;</td><td class="mdescRight">returns true if this instance only stores part of the weights of an entire model  <a href="classdismec_1_1model_1_1Model.html#a7e63006d06505dddb9d48264e6ca1fb9">More...</a><br /></td></tr>
<tr class="separator:a7e63006d06505dddb9d48264e6ca1fb9"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:adae5cb8a86072901274711d8411cbb13"><td class="memItemLeft" align="right" valign="top"><a class="el" href="classdismec_1_1label__id__t.html">label_id_t</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classdismec_1_1model_1_1Model.html#adae5cb8a86072901274711d8411cbb13">labels_begin</a> () const noexcept</td></tr>
<tr class="separator:adae5cb8a86072901274711d8411cbb13"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a0e6f617aaf552c26f9057341476b444a"><td class="memItemLeft" align="right" valign="top"><a class="el" href="classdismec_1_1label__id__t.html">label_id_t</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classdismec_1_1model_1_1Model.html#a0e6f617aaf552c26f9057341476b444a">labels_end</a> () const noexcept</td></tr>
<tr class="separator:a0e6f617aaf552c26f9057341476b444a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a5c2fa53bd647ca55b1353d6fc1f75e9b"><td class="memItemLeft" align="right" valign="top">long&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classdismec_1_1model_1_1Model.html#a5c2fa53bd647ca55b1353d6fc1f75e9b">contained_labels</a> () const noexcept</td></tr>
<tr class="memdesc:a5c2fa53bd647ca55b1353d6fc1f75e9b"><td class="mdescLeft">&#160;</td><td class="mdescRight">How many labels are in this submodel.  <a href="classdismec_1_1model_1_1Model.html#a5c2fa53bd647ca55b1353d6fc1f75e9b">More...</a><br /></td></tr>
<tr class="separator:a5c2fa53bd647ca55b1353d6fc1f75e9b"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac08b9af0b7e8e8e4691e0b1af354f0f2"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classdismec_1_1model_1_1Model.html#ac08b9af0b7e8e8e4691e0b1af354f0f2">get_weights_for_label</a> (<a class="el" href="classdismec_1_1label__id__t.html">label_id_t</a> label, Eigen::Ref&lt; <a class="el" href="namespacedismec.html#a5dd69ddc000503f763b811cf698b08c0">DenseRealVector</a> &gt; target) const</td></tr>
<tr class="memdesc:ac08b9af0b7e8e8e4691e0b1af354f0f2"><td class="mdescLeft">&#160;</td><td class="mdescRight">Gets the weights for the given label as a dense vector.  <a href="classdismec_1_1model_1_1Model.html#ac08b9af0b7e8e8e4691e0b1af354f0f2">More...</a><br /></td></tr>
<tr class="separator:ac08b9af0b7e8e8e4691e0b1af354f0f2"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a7c932e0ac926f72b9ef4d9fd8948693a"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classdismec_1_1model_1_1Model.html#a7c932e0ac926f72b9ef4d9fd8948693a">set_weights_for_label</a> (<a class="el" href="classdismec_1_1label__id__t.html">label_id_t</a> label, const <a class="el" href="classdismec_1_1model_1_1Model.html#a967fe576599e4401186bd34590ece765">WeightVectorIn</a> &amp;weights)</td></tr>
<tr class="memdesc:a7c932e0ac926f72b9ef4d9fd8948693a"><td class="mdescLeft">&#160;</td><td class="mdescRight">Sets the weights for a label.  <a href="classdismec_1_1model_1_1Model.html#a7c932e0ac926f72b9ef4d9fd8948693a">More...</a><br /></td></tr>
<tr class="separator:a7c932e0ac926f72b9ef4d9fd8948693a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aeba783ecf6fab8adfc3da1f664ebd81d"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classdismec_1_1model_1_1Model.html#aeba783ecf6fab8adfc3da1f664ebd81d">predict_scores</a> (const <a class="el" href="classdismec_1_1model_1_1Model.html#a1483094f44801656fefdce6f22d04b64">FeatureMatrixIn</a> &amp;instances, <a class="el" href="classdismec_1_1model_1_1Model.html#a643e6cd1377ecd1bb8ea93a93a503c93">PredictionMatrixOut</a> target) const</td></tr>
<tr class="memdesc:aeba783ecf6fab8adfc3da1f664ebd81d"><td class="mdescLeft">&#160;</td><td class="mdescRight">Calculates the scores for all examples and all labels in this model.  <a href="classdismec_1_1model_1_1Model.html#aeba783ecf6fab8adfc3da1f664ebd81d">More...</a><br /></td></tr>
<tr class="separator:aeba783ecf6fab8adfc3da1f664ebd81d"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="pro-methods"></a>
Protected Member Functions</h2></td></tr>
<tr class="memitem:af896abf2d26e1dfabd467e969bd71e36"><td class="memItemLeft" align="right" valign="top"><a class="el" href="classdismec_1_1label__id__t.html">label_id_t</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classdismec_1_1model_1_1Model.html#af896abf2d26e1dfabd467e969bd71e36">adjust_label</a> (<a class="el" href="classdismec_1_1label__id__t.html">label_id_t</a> label) const</td></tr>
<tr class="separator:af896abf2d26e1dfabd467e969bd71e36"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="pri-methods"></a>
Private Member Functions</h2></td></tr>
<tr class="memitem:a77afa2293b6dab733dec54c1560405ed"><td class="memItemLeft" align="right" valign="top">virtual void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classdismec_1_1model_1_1Model.html#a77afa2293b6dab733dec54c1560405ed">predict_scores_unchecked</a> (const <a class="el" href="classdismec_1_1model_1_1Model.html#a1483094f44801656fefdce6f22d04b64">FeatureMatrixIn</a> &amp;instances, <a class="el" href="classdismec_1_1model_1_1Model.html#a643e6cd1377ecd1bb8ea93a93a503c93">PredictionMatrixOut</a> target) const =0</td></tr>
<tr class="memdesc:a77afa2293b6dab733dec54c1560405ed"><td class="mdescLeft">&#160;</td><td class="mdescRight">Unchecked version of <a class="el" href="classdismec_1_1model_1_1Model.html#aeba783ecf6fab8adfc3da1f664ebd81d" title="Calculates the scores for all examples and all labels in this model.">predict_scores()</a>.  <a href="classdismec_1_1model_1_1Model.html#a77afa2293b6dab733dec54c1560405ed">More...</a><br /></td></tr>
<tr class="separator:a77afa2293b6dab733dec54c1560405ed"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a52241812a0027a80c3aedffad635b776"><td class="memItemLeft" align="right" valign="top">virtual void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classdismec_1_1model_1_1Model.html#a52241812a0027a80c3aedffad635b776">get_weights_for_label_unchecked</a> (<a class="el" href="classdismec_1_1label__id__t.html">label_id_t</a> label, Eigen::Ref&lt; <a class="el" href="namespacedismec.html#a5dd69ddc000503f763b811cf698b08c0">DenseRealVector</a> &gt; target) const =0</td></tr>
<tr class="memdesc:a52241812a0027a80c3aedffad635b776"><td class="mdescLeft">&#160;</td><td class="mdescRight">Unchecked version of <a class="el" href="classdismec_1_1model_1_1Model.html#ac08b9af0b7e8e8e4691e0b1af354f0f2" title="Gets the weights for the given label as a dense vector.">get_weights_for_label()</a>.  <a href="classdismec_1_1model_1_1Model.html#a52241812a0027a80c3aedffad635b776">More...</a><br /></td></tr>
<tr class="separator:a52241812a0027a80c3aedffad635b776"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a9d2bbb89189bedbcbd0311f515316326"><td class="memItemLeft" align="right" valign="top">virtual void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classdismec_1_1model_1_1Model.html#a9d2bbb89189bedbcbd0311f515316326">set_weights_for_label_unchecked</a> (<a class="el" href="classdismec_1_1label__id__t.html">label_id_t</a> label, const <a class="el" href="classdismec_1_1model_1_1Model.html#a967fe576599e4401186bd34590ece765">WeightVectorIn</a> &amp;weights)=0</td></tr>
<tr class="memdesc:a9d2bbb89189bedbcbd0311f515316326"><td class="mdescLeft">&#160;</td><td class="mdescRight">Unchecked version of <a class="el" href="classdismec_1_1model_1_1Model.html#a7c932e0ac926f72b9ef4d9fd8948693a" title="Sets the weights for a label.">set_weights_for_label()</a>.  <a href="classdismec_1_1model_1_1Model.html#a9d2bbb89189bedbcbd0311f515316326">More...</a><br /></td></tr>
<tr class="separator:a9d2bbb89189bedbcbd0311f515316326"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="pri-attribs"></a>
Private Attributes</h2></td></tr>
<tr class="memitem:a95495f54efef790840471f933a33c12a"><td class="memItemLeft" align="right" valign="top"><a class="el" href="classdismec_1_1label__id__t.html">label_id_t</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classdismec_1_1model_1_1Model.html#a95495f54efef790840471f933a33c12a">m_LabelsBegin</a></td></tr>
<tr class="separator:a95495f54efef790840471f933a33c12a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a897a84f07d2bf09948ccc19450e5f051"><td class="memItemLeft" align="right" valign="top"><a class="el" href="classdismec_1_1label__id__t.html">label_id_t</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classdismec_1_1model_1_1Model.html#a897a84f07d2bf09948ccc19450e5f051">m_LabelsEnd</a></td></tr>
<tr class="separator:a897a84f07d2bf09948ccc19450e5f051"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a9e9c7c837e6b2ab27393f9162b6575b5"><td class="memItemLeft" align="right" valign="top">long&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classdismec_1_1model_1_1Model.html#a9e9c7c837e6b2ab27393f9162b6575b5">m_NumLabels</a></td></tr>
<tr class="memdesc:a9e9c7c837e6b2ab27393f9162b6575b5"><td class="mdescLeft">&#160;</td><td class="mdescRight">Total number of labels of the complete model.  <a href="classdismec_1_1model_1_1Model.html#a9e9c7c837e6b2ab27393f9162b6575b5">More...</a><br /></td></tr>
<tr class="separator:a9e9c7c837e6b2ab27393f9162b6575b5"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><p>A model combines a set of weight with some meta-information about these weights. </p>
<p>The weights may be represented as a dense or as a sparse matrix. The model class allows access to model meta-data through functions such as</p><ul>
<li><a class="el" href="classdismec_1_1model_1_1Model.html#a47517b7d163661eb46404527944076c1">Model::num_labels()</a></li>
<li><a class="el" href="classdismec_1_1model_1_1Model.html#a31a7492ca66d9483bbe8eb723f186a9a">Model::num_features()</a></li>
<li><a class="el" href="classdismec_1_1model_1_1Model.html#a7893db5f731a51d97c0144b6049e43df">Model::has_sparse_weights()</a></li>
</ul>
<p>as well as access to the weights via</p><ul>
<li><a class="el" href="classdismec_1_1model_1_1Model.html#ac08b9af0b7e8e8e4691e0b1af354f0f2">Model::get_weights_for_label()</a></li>
<li><a class="el" href="classdismec_1_1model_1_1Model.html#a7c932e0ac926f72b9ef4d9fd8948693a">Model::set_weights_for_label()</a></li>
</ul>
<p>Finally, the class provides an interface for performing predictions. This is handled by the <a class="el" href="classdismec_1_1model_1_1Model.html#aeba783ecf6fab8adfc3da1f664ebd81d">Model::predict_scores</a> function, which exists in a version that handles dense features and one version that handles sparse feature vectors.</p>
<p>The current design abstract away whether the weights are saved internally in a dense or sparse representation, but this comes at the cost that getting and setting weights has sub-optimal performance characteristics for both sparse and dense data format. However, these functions are mostly for 1. IO. In th case we expect the actual IO cost to be much more than the in-memory copies 2. setting weights after training. Same. In both cases, the solution is to have one buffer per thread, and only do a single read or write.</p>
<p>For performance reasons, the model functions do not return newly constructed vectors, but instead expect the caller to provide a buffer in which they will place their values. Where appropriate, input vectors are not taken as Eigen::Ref objects so they can bind to sub-matrices. In that case, the caller needs to make sure that the resulting sub-objects have an inner stride of one. This allows e.g. to parallelize the prediction process over the examples.</p>
<dl class="todo"><dt><b><a class="el" href="todo.html#_todo000010">Todo:</a></b></dt><dd>what about per-label prediction? That would also be a valid axis for parallelizing.</dd></dl>
<p>Instances of the <code><a class="el" href="classdismec_1_1model_1_1Model.html" title="A model combines a set of weight with some meta-information about these weights.">Model</a></code> class can either represent an entire model, or a sub-model that only contains a contiguous subset of the weight vectors of the whole model. This is necessary e.g. to facility distributed-memory training and prediction. If only a subset of the weights are contained, then the labels can be queried by <a class="el" href="classdismec_1_1model_1_1Model.html#adae5cb8a86072901274711d8411cbb13">Model::labels_begin()</a> and <a class="el" href="classdismec_1_1model_1_1Model.html#a0e6f617aaf552c26f9057341476b444a">Model::labels_end()</a>. </p>

<p class="definition">Definition at line <a class="el" href="model_8h_source.html#l00063">63</a> of file <a class="el" href="model_8h_source.html">model.h</a>.</p>
</div><h2 class="groupheader">Member Typedef Documentation</h2>
<a id="a1483094f44801656fefdce6f22d04b64"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a1483094f44801656fefdce6f22d04b64">&#9670;&nbsp;</a></span>FeatureMatrixIn</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">using <a class="el" href="classdismec_1_1model_1_1Model.html#a1483094f44801656fefdce6f22d04b64">dismec::model::Model::FeatureMatrixIn</a> =  <a class="el" href="namespacedismec.html#ae37c14c95728812db1271c1ec0243017">GenericInMatrix</a></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="model_8h_source.html#l00066">66</a> of file <a class="el" href="model_8h_source.html">model.h</a>.</p>

</div>
</div>
<a id="a643e6cd1377ecd1bb8ea93a93a503c93"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a643e6cd1377ecd1bb8ea93a93a503c93">&#9670;&nbsp;</a></span>PredictionMatrixOut</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">using <a class="el" href="classdismec_1_1model_1_1Model.html#a643e6cd1377ecd1bb8ea93a93a503c93">dismec::model::Model::PredictionMatrixOut</a> =  Eigen::Ref&lt;<a class="el" href="namespacedismec.html#aa5bb6a768e148994d5f74ba63aa756c8">PredictionMatrix</a>&gt;</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="model_8h_source.html#l00065">65</a> of file <a class="el" href="model_8h_source.html">model.h</a>.</p>

</div>
</div>
<a id="a967fe576599e4401186bd34590ece765"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a967fe576599e4401186bd34590ece765">&#9670;&nbsp;</a></span>WeightVectorIn</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">using <a class="el" href="classdismec_1_1model_1_1Model.html#a967fe576599e4401186bd34590ece765">dismec::model::Model::WeightVectorIn</a> =  <a class="el" href="namespacedismec.html#ac5d82a0199ce34810c1ef57b38da5ca6">GenericInVector</a></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="model_8h_source.html#l00067">67</a> of file <a class="el" href="model_8h_source.html">model.h</a>.</p>

</div>
</div>
<h2 class="groupheader">Constructor &amp; Destructor Documentation</h2>
<a id="a3337cf0970846a390509719867d17ae1"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a3337cf0970846a390509719867d17ae1">&#9670;&nbsp;</a></span>Model()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">Model::Model </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structdismec_1_1model_1_1PartialModelSpec.html">PartialModelSpec</a>&#160;</td>
          <td class="paramname"><em>spec</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">explicit</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="model_8cpp_source.html#l00013">13</a> of file <a class="el" href="model_8cpp_source.html">model.cpp</a>.</p>

<p class="reference">References <a class="el" href="model_8h_source.html#l00176">m_LabelsBegin</a>, <a class="el" href="model_8h_source.html#l00177">m_LabelsEnd</a>, <a class="el" href="model_8h_source.html#l00185">m_NumLabels</a>, and <a class="el" href="opaque__int_8h_source.html#l00032">dismec::opaque_int_type&lt; Tag, T &gt;::to_index()</a>.</p>

</div>
</div>
<a id="aa023fec6ec01b1417a5087dc591c85c9"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aa023fec6ec01b1417a5087dc591c85c9">&#9670;&nbsp;</a></span>~Model()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">virtual dismec::model::Model::~Model </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">virtual</span><span class="mlabel">default</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

</div>
</div>
<h2 class="groupheader">Member Function Documentation</h2>
<a id="af896abf2d26e1dfabd467e969bd71e36"></a>
<h2 class="memtitle"><span class="permalink"><a href="#af896abf2d26e1dfabd467e969bd71e36">&#9670;&nbsp;</a></span>adjust_label()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classdismec_1_1label__id__t.html">label_id_t</a> Model::adjust_label </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="classdismec_1_1label__id__t.html">label_id_t</a>&#160;</td>
          <td class="paramname"><em>label</em></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>this function verifies that <code>label</code> is a valid label, in <code>[<a class="el" href="classdismec_1_1model_1_1Model.html#adae5cb8a86072901274711d8411cbb13">labels_begin()</a>, <a class="el" href="classdismec_1_1model_1_1Model.html#a0e6f617aaf552c26f9057341476b444a">labels_end()</a>)</code>, and returns a zero-based label, i.e. it subtracts <code><a class="el" href="classdismec_1_1model_1_1Model.html#adae5cb8a86072901274711d8411cbb13">labels_begin()</a></code>. </p>

<p class="definition">Definition at line <a class="el" href="model_8cpp_source.html#l00028">28</a> of file <a class="el" href="model_8cpp_source.html">model.cpp</a>.</p>

<p class="reference">References <a class="el" href="model_8h_source.html#l00098">labels_begin()</a>, <a class="el" href="model_8h_source.html#l00102">labels_end()</a>, and <a class="el" href="opaque__int_8h_source.html#l00032">dismec::opaque_int_type&lt; Tag, T &gt;::to_index()</a>.</p>

<p class="reference">Referenced by <a class="el" href="model_8cpp_source.html#l00041">get_weights_for_label()</a>, and <a class="el" href="model_8cpp_source.html#l00051">set_weights_for_label()</a>.</p>

</div>
</div>
<a id="a5c2fa53bd647ca55b1353d6fc1f75e9b"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a5c2fa53bd647ca55b1353d6fc1f75e9b">&#9670;&nbsp;</a></span>contained_labels()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">long dismec::model::Model::contained_labels </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span><span class="mlabel">noexcept</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>How many labels are in this submodel. </p>

<p class="definition">Definition at line <a class="el" href="model_8h_source.html#l00105">105</a> of file <a class="el" href="model_8h_source.html">model.h</a>.</p>

<p class="reference">References <a class="el" href="model_8h_source.html#l00176">m_LabelsBegin</a>, and <a class="el" href="model_8h_source.html#l00177">m_LabelsEnd</a>.</p>

<p class="reference">Referenced by <a class="el" href="weights_8cpp_source.html#l00082">dismec::io::model::load_dense_weights_npy()</a>, <a class="el" href="weights_8cpp_source.html#l00111">dismec::io::model::save_as_sparse_weights_txt()</a>, and <a class="el" href="weights_8cpp_source.html#l00073">dismec::io::model::save_dense_weights_npy()</a>.</p>

</div>
</div>
<a id="ac08b9af0b7e8e8e4691e0b1af354f0f2"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ac08b9af0b7e8e8e4691e0b1af354f0f2">&#9670;&nbsp;</a></span>get_weights_for_label()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void Model::get_weights_for_label </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="classdismec_1_1label__id__t.html">label_id_t</a>&#160;</td>
          <td class="paramname"><em>label</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">Eigen::Ref&lt; <a class="el" href="namespacedismec.html#a5dd69ddc000503f763b811cf698b08c0">DenseRealVector</a> &gt;&#160;</td>
          <td class="paramname"><em>target</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td> const</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Gets the weights for the given label as a dense vector. </p>
<p>Since we do not know whether the weights saved in the model are sparse or dense vectors, we cannot simply return a const reference here. Instead, the user is required to provide a pre-allocated buffer <code>target</code> into which the weights will be copied. </p><dl class="exception"><dt>Exceptions</dt><dd>
  <table class="exception">
    <tr><td class="paramname">If</td><td><code>target</code> does not have the correct size, or if <code>label</code> is invalid. </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="model_8cpp_source.html#l00041">41</a> of file <a class="el" href="model_8cpp_source.html">model.cpp</a>.</p>

<p class="reference">References <a class="el" href="model_8cpp_source.html#l00028">adjust_label()</a>, <a class="el" href="classdismec_1_1model_1_1Model.html#a52241812a0027a80c3aedffad635b776">get_weights_for_label_unchecked()</a>, and <a class="el" href="classdismec_1_1model_1_1Model.html#a31a7492ca66d9483bbe8eb723f186a9a">num_features()</a>.</p>

<p class="reference">Referenced by <a class="el" href="weights_8cpp_source.html#l00023">anonymous_namespace{weights.cpp}::save_weights()</a>.</p>

</div>
</div>
<a id="a52241812a0027a80c3aedffad635b776"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a52241812a0027a80c3aedffad635b776">&#9670;&nbsp;</a></span>get_weights_for_label_unchecked()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">virtual void dismec::model::Model::get_weights_for_label_unchecked </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="classdismec_1_1label__id__t.html">label_id_t</a>&#160;</td>
          <td class="paramname"><em>label</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">Eigen::Ref&lt; <a class="el" href="namespacedismec.html#a5dd69ddc000503f763b811cf698b08c0">DenseRealVector</a> &gt;&#160;</td>
          <td class="paramname"><em>target</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td> const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span><span class="mlabel">pure virtual</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Unchecked version of <a class="el" href="classdismec_1_1model_1_1Model.html#ac08b9af0b7e8e8e4691e0b1af354f0f2" title="Gets the weights for the given label as a dense vector.">get_weights_for_label()</a>. </p>
<p>Since we do not know whether the weights saved in the model are sparse or dense vectors, we cannot simply return a const reference here. Instead, the user is required to provide a pre-allocated buffer <code>target</code> into which the weights will be copied. </p><dl class="exception"><dt>Exceptions</dt><dd>
  <table class="exception">
    <tr><td class="paramname">If</td><td><code>target</code> does not have the correct size, or if <code>label</code> is invalid. </td></tr>
  </table>
  </dd>
</dl>
<dl class="section note"><dt>Note</dt><dd>This function is called from <code>get_weights_for_label</code> and can assume label is a valid label index that has been corrected for partial models (i.e. such that the first label of the partial model will get the index <code>0</code>). Target can be assumed to be of correct size. </dd></dl>

<p>Implemented in <a class="el" href="classdismec_1_1model_1_1SubModelWrapper.html#a3931a25868e809c2b01fc05d658d6e4a">dismec::model::SubModelWrapper&lt; T &gt;</a>, <a class="el" href="classdismec_1_1model_1_1SparseModel.html#acf71acd5575e79fc780a2221b3e8ba10">dismec::model::SparseModel</a>, and <a class="el" href="classdismec_1_1model_1_1DenseModel.html#ad2da990e17e872ea62070a89b8241ef2">dismec::model::DenseModel</a>.</p>

<p class="reference">Referenced by <a class="el" href="model_8cpp_source.html#l00041">get_weights_for_label()</a>.</p>

</div>
</div>
<a id="a7893db5f731a51d97c0144b6049e43df"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a7893db5f731a51d97c0144b6049e43df">&#9670;&nbsp;</a></span>has_sparse_weights()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">virtual bool dismec::model::Model::has_sparse_weights </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">pure virtual</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>whether this model stores the weights in a sparse format, or a dense format. </p>

<p>Implemented in <a class="el" href="classdismec_1_1model_1_1SubModelWrapper.html#a860e74483755dae549b62c57734c13d5">dismec::model::SubModelWrapper&lt; T &gt;</a>, <a class="el" href="classdismec_1_1model_1_1SparseModel.html#a62b0fc0e70eafcb18924dc2cbb2b5083">dismec::model::SparseModel</a>, and <a class="el" href="classdismec_1_1model_1_1DenseModel.html#a03a473eab53d69259ec194a5df0e94eb">dismec::model::DenseModel</a>.</p>

</div>
</div>
<a id="a7e63006d06505dddb9d48264e6ca1fb9"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a7e63006d06505dddb9d48264e6ca1fb9">&#9670;&nbsp;</a></span>is_partial_model()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">bool Model::is_partial_model </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>returns true if this instance only stores part of the weights of an entire model </p>

<p class="definition">Definition at line <a class="el" href="model_8cpp_source.html#l00037">37</a> of file <a class="el" href="model_8cpp_source.html">model.cpp</a>.</p>

<p class="reference">References <a class="el" href="model_8h_source.html#l00176">m_LabelsBegin</a>, <a class="el" href="model_8h_source.html#l00177">m_LabelsEnd</a>, <a class="el" href="model_8h_source.html#l00078">num_labels()</a>, and <a class="el" href="opaque__int_8h_source.html#l00032">dismec::opaque_int_type&lt; Tag, T &gt;::to_index()</a>.</p>

<p class="reference">Referenced by <a class="el" href="dense__test_8cpp_source.html#l00094">TEST_CASE()</a>.</p>

</div>
</div>
<a id="adae5cb8a86072901274711d8411cbb13"></a>
<h2 class="memtitle"><span class="permalink"><a href="#adae5cb8a86072901274711d8411cbb13">&#9670;&nbsp;</a></span>labels_begin()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classdismec_1_1label__id__t.html">label_id_t</a> dismec::model::Model::labels_begin </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span><span class="mlabel">noexcept</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>If this is a partial model, returns the index of the first label for which weight vectors are available. For a complete model this always returns 0. </p>

<p class="definition">Definition at line <a class="el" href="model_8h_source.html#l00098">98</a> of file <a class="el" href="model_8h_source.html">model.h</a>.</p>

<p class="reference">References <a class="el" href="model_8h_source.html#l00176">m_LabelsBegin</a>.</p>

<p class="reference">Referenced by <a class="el" href="model_8cpp_source.html#l00028">adjust_label()</a>, <a class="el" href="submodel_8h_source.html#l00025">dismec::model::SubModelWrapper&lt; T &gt;::get_weights_for_label_unchecked()</a>, <a class="el" href="weights_8cpp_source.html#l00140">dismec::io::model::load_sparse_weights_txt()</a>, <a class="el" href="weights_8cpp_source.html#l00037">anonymous_namespace{weights.cpp}::load_weights()</a>, <a class="el" href="model_8h_source.html#l00087">num_weights()</a>, <a class="el" href="weights_8cpp_source.html#l00023">anonymous_namespace{weights.cpp}::save_weights()</a>, <a class="el" href="submodel_8h_source.html#l00029">dismec::model::SubModelWrapper&lt; T &gt;::set_weights_for_label_unchecked()</a>, and <a class="el" href="dense__test_8cpp_source.html#l00094">TEST_CASE()</a>.</p>

</div>
</div>
<a id="a0e6f617aaf552c26f9057341476b444a"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a0e6f617aaf552c26f9057341476b444a">&#9670;&nbsp;</a></span>labels_end()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classdismec_1_1label__id__t.html">label_id_t</a> dismec::model::Model::labels_end </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span><span class="mlabel">noexcept</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>If this is a partial, returns the first label index for which no weights are available. For a complete model this returns <code><a class="el" href="classdismec_1_1model_1_1Model.html#a47517b7d163661eb46404527944076c1" title="How many labels are in the underlying dataset.">num_labels()</a></code> </p>

<p class="definition">Definition at line <a class="el" href="model_8h_source.html#l00102">102</a> of file <a class="el" href="model_8h_source.html">model.h</a>.</p>

<p class="reference">References <a class="el" href="model_8h_source.html#l00177">m_LabelsEnd</a>.</p>

<p class="reference">Referenced by <a class="el" href="model_8cpp_source.html#l00028">adjust_label()</a>, <a class="el" href="weights_8cpp_source.html#l00140">dismec::io::model::load_sparse_weights_txt()</a>, <a class="el" href="weights_8cpp_source.html#l00037">anonymous_namespace{weights.cpp}::load_weights()</a>, <a class="el" href="model_8h_source.html#l00087">num_weights()</a>, <a class="el" href="weights_8cpp_source.html#l00023">anonymous_namespace{weights.cpp}::save_weights()</a>, and <a class="el" href="dense__test_8cpp_source.html#l00094">TEST_CASE()</a>.</p>

</div>
</div>
<a id="a31a7492ca66d9483bbe8eb723f186a9a"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a31a7492ca66d9483bbe8eb723f186a9a">&#9670;&nbsp;</a></span>num_features()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">virtual long dismec::model::Model::num_features </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">pure virtual</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>How many weights are in each weight vector, i.e. how many features should the input have. </p>

<p>Implemented in <a class="el" href="classdismec_1_1model_1_1SubModelWrapper.html#aee38841b9b99a78853930fad5d7f6f89">dismec::model::SubModelWrapper&lt; T &gt;</a>, <a class="el" href="classdismec_1_1model_1_1SparseModel.html#a1ef3f3f31007e6633c8894895b6ec0bd">dismec::model::SparseModel</a>, and <a class="el" href="classdismec_1_1model_1_1DenseModel.html#a8fcb75ccce0a258e9647135a623292dc">dismec::model::DenseModel</a>.</p>

<p class="reference">Referenced by <a class="el" href="model_8cpp_source.html#l00041">get_weights_for_label()</a>, <a class="el" href="weights_8cpp_source.html#l00082">dismec::io::model::load_dense_weights_npy()</a>, <a class="el" href="weights_8cpp_source.html#l00140">dismec::io::model::load_sparse_weights_txt()</a>, <a class="el" href="weights_8cpp_source.html#l00037">anonymous_namespace{weights.cpp}::load_weights()</a>, <a class="el" href="model_8cpp_source.html#l00060">predict_scores()</a>, <a class="el" href="weights_8cpp_source.html#l00111">dismec::io::model::save_as_sparse_weights_txt()</a>, <a class="el" href="weights_8cpp_source.html#l00073">dismec::io::model::save_dense_weights_npy()</a>, <a class="el" href="weights_8cpp_source.html#l00023">anonymous_namespace{weights.cpp}::save_weights()</a>, and <a class="el" href="model_8cpp_source.html#l00051">set_weights_for_label()</a>.</p>

</div>
</div>
<a id="a47517b7d163661eb46404527944076c1"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a47517b7d163661eb46404527944076c1">&#9670;&nbsp;</a></span>num_labels()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">long dismec::model::Model::num_labels </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span><span class="mlabel">noexcept</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>How many labels are in the underlying dataset. </p>
<p>If <code><a class="el" href="classdismec_1_1model_1_1Model.html#a7e63006d06505dddb9d48264e6ca1fb9" title="returns true if this instance only stores part of the weights of an entire model">is_partial_model()</a></code> is false, this is equal to the number of weights in this model. </p>

<p class="definition">Definition at line <a class="el" href="model_8h_source.html#l00078">78</a> of file <a class="el" href="model_8h_source.html">model.h</a>.</p>

<p class="reference">References <a class="el" href="model_8h_source.html#l00185">m_NumLabels</a>.</p>

<p class="reference">Referenced by <a class="el" href="model_8cpp_source.html#l00037">is_partial_model()</a>, <a class="el" href="weights_8cpp_source.html#l00140">dismec::io::model::load_sparse_weights_txt()</a>, and <a class="el" href="dense__test_8cpp_source.html#l00094">TEST_CASE()</a>.</p>

</div>
</div>
<a id="a8e691012eaafde6dbcdc171bd21a3282"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a8e691012eaafde6dbcdc171bd21a3282">&#9670;&nbsp;</a></span>num_weights()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">long dismec::model::Model::num_weights </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span><span class="mlabel">noexcept</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>How many weights vectors are in this model. </p>
<p>If <code>is_partial_model</code> is false, this is equal to the number of labels. </p>

<p class="definition">Definition at line <a class="el" href="model_8h_source.html#l00087">87</a> of file <a class="el" href="model_8h_source.html">model.h</a>.</p>

<p class="reference">References <a class="el" href="model_8h_source.html#l00098">labels_begin()</a>, and <a class="el" href="model_8h_source.html#l00102">labels_end()</a>.</p>

<p class="reference">Referenced by <a class="el" href="model_8cpp_source.html#l00060">predict_scores()</a>, and <a class="el" href="dense__test_8cpp_source.html#l00094">TEST_CASE()</a>.</p>

</div>
</div>
<a id="aeba783ecf6fab8adfc3da1f664ebd81d"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aeba783ecf6fab8adfc3da1f664ebd81d">&#9670;&nbsp;</a></span>predict_scores()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void Model::predict_scores </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="classdismec_1_1model_1_1Model.html#a1483094f44801656fefdce6f22d04b64">FeatureMatrixIn</a> &amp;&#160;</td>
          <td class="paramname"><em>instances</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classdismec_1_1model_1_1Model.html#a643e6cd1377ecd1bb8ea93a93a503c93">PredictionMatrixOut</a>&#160;</td>
          <td class="paramname"><em>target</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td> const</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Calculates the scores for all examples and all labels in this model. </p>
<p>This is just the matrix multiplication of the input instances and the weight matrix. This function can be called safely from multiple threads. Note that Eigen::Ref requires that the passed submatrix has an inner stride of 1, i.e. that features for a single instance are provided as contiguous memory (in case of dense features), and the same for the pre-allocated buffer for the targets. This can be achieved e.g. by using rows of a row-major matrix. </p><dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">instances</td><td>Feature vector of the instances for which we want to predict the scores. This is handled as a <code>Eigen::Ref</code> parameter so that subsets of a large dataset can be passed without needing data to be copied. Should have number of columns equal to the number of features. The <code>GenericInMatrix</code> allows different data formats to be passed &ndash; however, some data formats may be more efficient than others. </td></tr>
    <tr><td class="paramname">target</td><td>This is the matrix to which the scores will be written. Has to have the correct size, i.e. the same number of rows as <code>instances</code> and number of columns equal to the number of labels. </td></tr>
  </table>
  </dd>
</dl>
<dl class="exception"><dt>Exceptions</dt><dd>
  <table class="exception">
    <tr><td class="paramname">If</td><td><code>instances</code> and <code>target</code> have different number of rows, or if the number of columns (rows) in <code>instances</code> (<code>target</code>) does not match <code>get_num_features()</code> (<code>get_num_labels()</code>). </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="model_8cpp_source.html#l00060">60</a> of file <a class="el" href="model_8cpp_source.html">model.cpp</a>.</p>

<p class="reference">References <a class="el" href="eigen__generic_8h_source.html#l00053">dismec::types::EigenVariantWrapper&lt; Types &gt;::cols()</a>, <a class="el" href="classdismec_1_1model_1_1Model.html#a31a7492ca66d9483bbe8eb723f186a9a">num_features()</a>, <a class="el" href="model_8h_source.html#l00087">num_weights()</a>, <a class="el" href="classdismec_1_1model_1_1Model.html#a77afa2293b6dab733dec54c1560405ed">predict_scores_unchecked()</a>, and <a class="el" href="eigen__generic_8h_source.html#l00049">dismec::types::EigenVariantWrapper&lt; Types &gt;::rows()</a>.</p>

</div>
</div>
<a id="a77afa2293b6dab733dec54c1560405ed"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a77afa2293b6dab733dec54c1560405ed">&#9670;&nbsp;</a></span>predict_scores_unchecked()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">virtual void dismec::model::Model::predict_scores_unchecked </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="classdismec_1_1model_1_1Model.html#a1483094f44801656fefdce6f22d04b64">FeatureMatrixIn</a> &amp;&#160;</td>
          <td class="paramname"><em>instances</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classdismec_1_1model_1_1Model.html#a643e6cd1377ecd1bb8ea93a93a503c93">PredictionMatrixOut</a>&#160;</td>
          <td class="paramname"><em>target</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td> const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span><span class="mlabel">pure virtual</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Unchecked version of <a class="el" href="classdismec_1_1model_1_1Model.html#aeba783ecf6fab8adfc3da1f664ebd81d" title="Calculates the scores for all examples and all labels in this model.">predict_scores()</a>. </p>
<p>This is just the matrix multiplication of the input instances and the weight matrix. This function can be called safely from multiple threads. Note that Eigen::Ref requires that the passed submatrix has an inner stride of 1, i.e. that features for a single instance are provided as contiguous memory (in case of dense features), and the same for the pre-allocated buffer for the targets. This can be achieved e.g. by using rows of a row-major matrix. </p><dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">instances</td><td>Feature vector of the instances for which we want to predict the scores. This is handled as a <code>Eigen::Ref</code> parameter so that subsets of a large dataset can be passed without needing data to be copied. Should have number of columns equal to the number of features. The <code>GenericInMatrix</code> allows different data formats to be passed &ndash; however, some data formats may be more efficient than others. </td></tr>
    <tr><td class="paramname">target</td><td>This is the matrix to which the scores will be written. Has to have the correct size, i.e. the same number of rows as <code>instances</code> and number of columns equal to the number of labels. </td></tr>
  </table>
  </dd>
</dl>
<dl class="exception"><dt>Exceptions</dt><dd>
  <table class="exception">
    <tr><td class="paramname">If</td><td><code>instances</code> and <code>target</code> have different number of rows, or if the number of columns (rows) in <code>instances</code> (<code>target</code>) does not match <code>get_num_features()</code> (<code>get_num_labels()</code>). </td></tr>
  </table>
  </dd>
</dl>
<dl class="section note"><dt>Note</dt><dd>This function is called from <code>predict_scores</code> and can assume that the shapes of <code>instances</code> and <code>target</code> have been verified. </dd></dl>

<p>Implemented in <a class="el" href="classdismec_1_1model_1_1SubModelWrapper.html#abe1e71051ec3d7bd994d824e353c6c83">dismec::model::SubModelWrapper&lt; T &gt;</a>, <a class="el" href="classdismec_1_1model_1_1SparseModel.html#a22b5c089bc28f8af1c5699df3f2bdc01">dismec::model::SparseModel</a>, and <a class="el" href="classdismec_1_1model_1_1DenseModel.html#a91b4e7ef34d41b50f3cdcf54e1f1f1ba">dismec::model::DenseModel</a>.</p>

<p class="reference">Referenced by <a class="el" href="model_8cpp_source.html#l00060">predict_scores()</a>.</p>

</div>
</div>
<a id="a7c932e0ac926f72b9ef4d9fd8948693a"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a7c932e0ac926f72b9ef4d9fd8948693a">&#9670;&nbsp;</a></span>set_weights_for_label()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void Model::set_weights_for_label </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="classdismec_1_1label__id__t.html">label_id_t</a>&#160;</td>
          <td class="paramname"><em>label</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="classdismec_1_1model_1_1Model.html#a967fe576599e4401186bd34590ece765">WeightVectorIn</a> &amp;&#160;</td>
          <td class="paramname"><em>weights</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Sets the weights for a label. </p>
<p>This assigns the given vector as weights for the <code>label</code>th label. For non-overlapping <code>label</code> parameters this function can safely be called concurrently from different threads. This function can be used for both dense and sparse internal weight representation. If the model internally uses a sparse representation, the zeros will be filtered out. </p><dl class="exception"><dt>Exceptions</dt><dd>
  <table class="exception">
    <tr><td class="paramname">If</td><td><code>weights</code> does not have the correct size, or if <code>label</code> is invalid. </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="model_8cpp_source.html#l00051">51</a> of file <a class="el" href="model_8cpp_source.html">model.cpp</a>.</p>

<p class="reference">References <a class="el" href="model_8cpp_source.html#l00028">adjust_label()</a>, <a class="el" href="classdismec_1_1model_1_1Model.html#a31a7492ca66d9483bbe8eb723f186a9a">num_features()</a>, <a class="el" href="classdismec_1_1model_1_1Model.html#a9d2bbb89189bedbcbd0311f515316326">set_weights_for_label_unchecked()</a>, and <a class="el" href="eigen__generic_8h_source.html#l00045">dismec::types::EigenVariantWrapper&lt; Types &gt;::size()</a>.</p>

<p class="reference">Referenced by <a class="el" href="weights_8cpp_source.html#l00140">dismec::io::model::load_sparse_weights_txt()</a>, and <a class="el" href="weights_8cpp_source.html#l00037">anonymous_namespace{weights.cpp}::load_weights()</a>.</p>

</div>
</div>
<a id="a9d2bbb89189bedbcbd0311f515316326"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a9d2bbb89189bedbcbd0311f515316326">&#9670;&nbsp;</a></span>set_weights_for_label_unchecked()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">virtual void dismec::model::Model::set_weights_for_label_unchecked </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="classdismec_1_1label__id__t.html">label_id_t</a>&#160;</td>
          <td class="paramname"><em>label</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="classdismec_1_1model_1_1Model.html#a967fe576599e4401186bd34590ece765">WeightVectorIn</a> &amp;&#160;</td>
          <td class="paramname"><em>weights</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span><span class="mlabel">pure virtual</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Unchecked version of <a class="el" href="classdismec_1_1model_1_1Model.html#a7c932e0ac926f72b9ef4d9fd8948693a" title="Sets the weights for a label.">set_weights_for_label()</a>. </p>
<p>This assigns the given vector as weights for the <code>label</code>th label. For non-overlapping <code>label</code> parameters this function can safely be called concurrently from different threads. This function can be used for both dense and sparse internal weight representation. If the model internally uses a sparse representation, the zeros will be filtered out. </p><dl class="exception"><dt>Exceptions</dt><dd>
  <table class="exception">
    <tr><td class="paramname">If</td><td><code>weights</code> does not have the correct size, or if <code>label</code> is invalid. </td></tr>
  </table>
  </dd>
</dl>
<dl class="section note"><dt>Note</dt><dd>This function is called from <code>set_weights_for_label</code> and can assume label is a valid label index that has been corrected for partial models (i.e. such that the first label of the partial model will get the index <code>0</code>). <code>weights</code> can be assumed to be of correct size. </dd></dl>

<p>Implemented in <a class="el" href="classdismec_1_1model_1_1SparseModel.html#a3976d3f85a54abb26f57192f34c1a798">dismec::model::SparseModel</a>, <a class="el" href="classdismec_1_1model_1_1DenseModel.html#a54ecbe7bcc2619264ae0fed176482168">dismec::model::DenseModel</a>, and <a class="el" href="classdismec_1_1model_1_1SubModelWrapper.html#ae4ce1f93be21c4378571e1fa695e36bb">dismec::model::SubModelWrapper&lt; T &gt;</a>.</p>

<p class="reference">Referenced by <a class="el" href="model_8cpp_source.html#l00051">set_weights_for_label()</a>.</p>

</div>
</div>
<h2 class="groupheader">Member Data Documentation</h2>
<a id="a95495f54efef790840471f933a33c12a"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a95495f54efef790840471f933a33c12a">&#9670;&nbsp;</a></span>m_LabelsBegin</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classdismec_1_1label__id__t.html">label_id_t</a> dismec::model::Model::m_LabelsBegin</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="model_8h_source.html#l00176">176</a> of file <a class="el" href="model_8h_source.html">model.h</a>.</p>

<p class="reference">Referenced by <a class="el" href="model_8h_source.html#l00105">contained_labels()</a>, <a class="el" href="model_8cpp_source.html#l00037">is_partial_model()</a>, <a class="el" href="model_8h_source.html#l00098">labels_begin()</a>, and <a class="el" href="model_8cpp_source.html#l00013">Model()</a>.</p>

</div>
</div>
<a id="a897a84f07d2bf09948ccc19450e5f051"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a897a84f07d2bf09948ccc19450e5f051">&#9670;&nbsp;</a></span>m_LabelsEnd</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classdismec_1_1label__id__t.html">label_id_t</a> dismec::model::Model::m_LabelsEnd</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="model_8h_source.html#l00177">177</a> of file <a class="el" href="model_8h_source.html">model.h</a>.</p>

<p class="reference">Referenced by <a class="el" href="model_8h_source.html#l00105">contained_labels()</a>, <a class="el" href="model_8cpp_source.html#l00037">is_partial_model()</a>, <a class="el" href="model_8h_source.html#l00102">labels_end()</a>, and <a class="el" href="model_8cpp_source.html#l00013">Model()</a>.</p>

</div>
</div>
<a id="a9e9c7c837e6b2ab27393f9162b6575b5"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a9e9c7c837e6b2ab27393f9162b6575b5">&#9670;&nbsp;</a></span>m_NumLabels</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">long dismec::model::Model::m_NumLabels</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Total number of labels of the complete model. </p>
<p>if this is a partial model, the information about the number of total labels cannot be extracted from weights. </p>

<p class="definition">Definition at line <a class="el" href="model_8h_source.html#l00185">185</a> of file <a class="el" href="model_8h_source.html">model.h</a>.</p>

<p class="reference">Referenced by <a class="el" href="model_8cpp_source.html#l00013">Model()</a>, and <a class="el" href="model_8h_source.html#l00078">num_labels()</a>.</p>

</div>
</div>
<hr/>The documentation for this class was generated from the following files:<ul>
<li>src/model/<a class="el" href="model_8h_source.html">model.h</a></li>
<li>src/model/<a class="el" href="model_8cpp_source.html">model.cpp</a></li>
</ul>
</div><!-- contents -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="navelem"><a class="el" href="namespacedismec.html">dismec</a></li><li class="navelem"><a class="el" href="namespacedismec_1_1model.html">model</a></li><li class="navelem"><a class="el" href="classdismec_1_1model_1_1Model.html">Model</a></li>
    <li class="footer">Generated by <a href="https://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.9.1 </li>
  </ul>
</div>
</body>
</html>
