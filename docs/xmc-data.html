<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.9.1"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>DiSMEC++: XMC data format</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/x-mathjax-config">
  MathJax.Hub.Config({
    extensions: ["tex2jax.js"],
    jax: ["input/TeX","output/HTML-CSS"],
});
</script>
<script type="text/javascript" async="async" src="https://cdn.jsdelivr.net/npm/mathjax@2/MathJax.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">DiSMEC++
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.9.1 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
var searchBox = new SearchBox("searchBox", "search",false,'Search','.html');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */</script>
<div id="main-nav"></div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(document).ready(function(){initNavTree('xmc-data.html',''); initResizable(); });
/* @license-end */
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="PageDoc"><div class="header">
  <div class="headertitle">
<div class="title">XMC data format </div>  </div>
</div><!--header-->
<div class="contents">
<div class="textblock"><p>This is the data format used e.g. here <code><a href="http://manikvarma.org/downloads/XC/XMLRepository.html">http://manikvarma.org/downloads/XC/XMLRepository.html</a></code>. It supports multiple labels per example, and encodes features and labels in a sparse format. Can be read using the io::read_xmc_dataset function.</p>
<h1><a class="anchor" id="Format"></a>
Specification</h1>
<p>Files start with a header line, which contains three positive integers that denote the number of instances (i.e. number of lines following) as well as number of features and number of labels. This is followed by one line for each instance, which has first a comma-separated list of label ids and then a space-separated list of sparse features, where each sparse feature consists of an integer feature index and a real-valued feature value, separated by a colon. The comma and colon need to follow the preceding number immediately (i.e. without whitespace), but can themselves be followed by whitespace. An empty label list has to be indicated by the line starting with a whitespace character. Both spaces and tabs are recognized as whitespace. Empty lines are ignored, if you have an example without labels where all features are zero, you have to specify one of the features with an explicit zero. We also skip any line whose first character is a <code>#</code>. Placing <code>#</code> at any other location is an error.</p>
<p>An example file would be </p><div class="fragment"><div class="line">3 10 5</div>
<div class="line"><span class="preprocessor"># 3 instances, 10 features {0, ..., 9} and 5 labels {0, ..., 4}</span></div>
<div class="line">2     4:1.0     5:-0.5</div>
<div class="line">1, 4  2:1.0e-4</div>
<div class="line">0,1   0:0.5     3:2.2</div>
</div><!-- fragment --><p>We also support reading files in which features and labels are indexed starting from one. In that case, set <code>IndexMode</code> to io::IndexMode::ONE_BASED.</p>
<h1><a class="anchor" id="Implementation"></a>
Details</h1>
<p>The functions for reading xmc data are defined in <a class="el" href="xmc_8cpp.html">xmc.cpp</a>. In broad terms, the reading works as follows: First, one quick pass is performed over the entire dataset, in which we count the number of occurrences of <code>:</code> characters. This allows us to pre-allocate the buffers for the sparse feature matrix immediately at the correct size, so that all insert operations will be <code>O(1)</code>. The second pass then does the actual number parsing. In that case, I expect no disk read overhead, since the data should still be cached in RAM, but I have not verified this. However, from a fast SSD, reading about 1.5GB of data file takes less than 15 seconds, so this is not a bottleneck.</p>
<p>To support both 0 and 1 based indexing, the internal reading method is templated over an <code>IndexOffset</code> integer parameter, which is either one or zero. In that way, we get optimized code for the default (=0) setting, but can still easily support 1-based indexing.</p>
<p>Why do we allow for spaces after the separators, but not before? The reason is simply that these spaces are automatically skipped by the conversion functions from the standard library, so disallowing them would in fact be extra work on our side. On the other hand, by not allowing spaces after the numbers, we can immediately check if the feature list has ended (space) or will continue (,), without needing to look ahead. </p>
</div></div><!-- contents -->
</div><!-- PageDoc -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="footer">Generated by <a href="https://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.9.1 </li>
  </ul>
</div>
</body>
</html>
