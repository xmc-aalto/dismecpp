<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.9.1"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>DiSMEC++: dismec::io::model::PartialModelSaver Class Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/x-mathjax-config">
  MathJax.Hub.Config({
    extensions: ["tex2jax.js"],
    jax: ["input/TeX","output/HTML-CSS"],
});
</script>
<script type="text/javascript" async="async" src="https://cdn.jsdelivr.net/npm/mathjax@2/MathJax.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">DiSMEC++
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.9.1 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
var searchBox = new SearchBox("searchBox", "search",false,'Search','.html');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */</script>
<div id="main-nav"></div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(document).ready(function(){initNavTree('classdismec_1_1io_1_1model_1_1PartialModelSaver.html',''); initResizable(); });
/* @license-end */
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="header">
  <div class="summary">
<a href="#pub-methods">Public Member Functions</a> &#124;
<a href="#pri-attribs">Private Attributes</a> &#124;
<a href="classdismec_1_1io_1_1model_1_1PartialModelSaver-members.html">List of all members</a>  </div>
  <div class="headertitle">
<div class="title">dismec::io::model::PartialModelSaver Class Reference</div>  </div>
</div><!--header-->
<div class="contents">

<p>Manage saving a model consisting of multiple partial models.  
 <a href="classdismec_1_1io_1_1model_1_1PartialModelSaver.html#details">More...</a></p>

<p><code>#include &lt;<a class="el" href="model-io_8h_source.html">model-io.h</a>&gt;</code></p>
<div class="dynheader">
Inheritance diagram for dismec::io::model::PartialModelSaver:</div>
<div class="dyncontent">
 <div class="center">
  <img src="classdismec_1_1io_1_1model_1_1PartialModelSaver.png" usemap="#dismec::io::model::PartialModelSaver_map" alt=""/>
  <map id="dismec::io::model::PartialModelSaver_map" name="dismec::io::model::PartialModelSaver_map">
<area href="classdismec_1_1io_1_1model_1_1PartialModelIO.html" title="This class is used as an implementation detail to capture the common code of PartialModelSaver and Pa..." alt="dismec::io::model::PartialModelIO" shape="rect" coords="0,0,217,24"/>
  </map>
</div></div>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="pub-methods"></a>
Public Member Functions</h2></td></tr>
<tr class="memitem:a2756f72407e4d8731fbe758729cc0ddd"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classdismec_1_1io_1_1model_1_1PartialModelSaver.html#a2756f72407e4d8731fbe758729cc0ddd">PartialModelSaver</a> (path target_file, <a class="el" href="structdismec_1_1io_1_1model_1_1SaveOption.html">SaveOption</a> options, bool load_partial=false)</td></tr>
<tr class="memdesc:a2756f72407e4d8731fbe758729cc0ddd"><td class="mdescLeft">&#160;</td><td class="mdescRight">Create a new <a class="el" href="classdismec_1_1io_1_1model_1_1PartialModelSaver.html" title="Manage saving a model consisting of multiple partial models.">PartialModelSaver</a>.  <a href="classdismec_1_1io_1_1model_1_1PartialModelSaver.html#a2756f72407e4d8731fbe758729cc0ddd">More...</a><br /></td></tr>
<tr class="separator:a2756f72407e4d8731fbe758729cc0ddd"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a704d4ae447cb0d7cef57a739bc107711"><td class="memItemLeft" align="right" valign="top">std::future&lt; <a class="el" href="structdismec_1_1io_1_1model_1_1WeightFileEntry.html">WeightFileEntry</a> &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classdismec_1_1io_1_1model_1_1PartialModelSaver.html#a704d4ae447cb0d7cef57a739bc107711">add_model</a> (const std::shared_ptr&lt; const <a class="el" href="classdismec_1_1model_1_1Model.html">Model</a> &gt; &amp;model, const std::optional&lt; std::string &gt; &amp;file_path={})</td></tr>
<tr class="memdesc:a704d4ae447cb0d7cef57a739bc107711"><td class="mdescLeft">&#160;</td><td class="mdescRight">Adds the weights of a partial model asynchronously.  <a href="classdismec_1_1io_1_1model_1_1PartialModelSaver.html#a704d4ae447cb0d7cef57a739bc107711">More...</a><br /></td></tr>
<tr class="separator:a704d4ae447cb0d7cef57a739bc107711"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:abc33455d761a5683ad624a0493b62a96"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classdismec_1_1io_1_1model_1_1PartialModelSaver.html#abc33455d761a5683ad624a0493b62a96">update_meta_file</a> ()</td></tr>
<tr class="memdesc:abc33455d761a5683ad624a0493b62a96"><td class="mdescLeft">&#160;</td><td class="mdescRight">Updates the metadata file.  <a href="classdismec_1_1io_1_1model_1_1PartialModelSaver.html#abc33455d761a5683ad624a0493b62a96">More...</a><br /></td></tr>
<tr class="separator:abc33455d761a5683ad624a0493b62a96"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a0a11816ca461bb21679ef21d6d186b85"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classdismec_1_1io_1_1model_1_1PartialModelSaver.html#a0a11816ca461bb21679ef21d6d186b85">finalize</a> ()</td></tr>
<tr class="memdesc:a0a11816ca461bb21679ef21d6d186b85"><td class="mdescLeft">&#160;</td><td class="mdescRight">Checks that all weights have been written and updates the metadata file.  <a href="classdismec_1_1io_1_1model_1_1PartialModelSaver.html#a0a11816ca461bb21679ef21d6d186b85">More...</a><br /></td></tr>
<tr class="separator:a0a11816ca461bb21679ef21d6d186b85"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a5c038996f9fa1f9bdb0921a0b79be347"><td class="memItemLeft" align="right" valign="top">std::pair&lt; <a class="el" href="classdismec_1_1label__id__t.html">label_id_t</a>, <a class="el" href="classdismec_1_1label__id__t.html">label_id_t</a> &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classdismec_1_1io_1_1model_1_1PartialModelSaver.html#a5c038996f9fa1f9bdb0921a0b79be347">get_missing_weights</a> () const</td></tr>
<tr class="memdesc:a5c038996f9fa1f9bdb0921a0b79be347"><td class="mdescLeft">&#160;</td><td class="mdescRight">Get an interval labels for which weights are missing.  <a href="classdismec_1_1io_1_1model_1_1PartialModelSaver.html#a5c038996f9fa1f9bdb0921a0b79be347">More...</a><br /></td></tr>
<tr class="separator:a5c038996f9fa1f9bdb0921a0b79be347"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a5a62294a58a47848a0ad537a6da428e1"><td class="memItemLeft" align="right" valign="top">bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classdismec_1_1io_1_1model_1_1PartialModelSaver.html#a5a62294a58a47848a0ad537a6da428e1">any_weight_vector_for_interval</a> (<a class="el" href="classdismec_1_1label__id__t.html">label_id_t</a> begin, <a class="el" href="classdismec_1_1label__id__t.html">label_id_t</a> end) const</td></tr>
<tr class="memdesc:a5a62294a58a47848a0ad537a6da428e1"><td class="mdescLeft">&#160;</td><td class="mdescRight">Checks if there are any weight vectors for the given interval.  <a href="classdismec_1_1io_1_1model_1_1PartialModelSaver.html#a5a62294a58a47848a0ad537a6da428e1">More...</a><br /></td></tr>
<tr class="separator:a5a62294a58a47848a0ad537a6da428e1"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a7df515ff71cf7cb781202cca12c61cde"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classdismec_1_1io_1_1model_1_1PartialModelSaver.html#a7df515ff71cf7cb781202cca12c61cde">insert_sub_file</a> (const <a class="el" href="structdismec_1_1io_1_1model_1_1WeightFileEntry.html">WeightFileEntry</a> &amp;data)</td></tr>
<tr class="memdesc:a7df515ff71cf7cb781202cca12c61cde"><td class="mdescLeft">&#160;</td><td class="mdescRight">Inserts a new sub-file entry into the metadata object.  <a href="classdismec_1_1io_1_1model_1_1PartialModelSaver.html#a7df515ff71cf7cb781202cca12c61cde">More...</a><br /></td></tr>
<tr class="separator:a7df515ff71cf7cb781202cca12c61cde"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="inherit_header pub_methods_classdismec_1_1io_1_1model_1_1PartialModelIO"><td colspan="2" onclick="javascript:toggleInherit('pub_methods_classdismec_1_1io_1_1model_1_1PartialModelIO')"><img src="closed.png" alt="-"/>&#160;Public Member Functions inherited from <a class="el" href="classdismec_1_1io_1_1model_1_1PartialModelIO.html">dismec::io::model::PartialModelIO</a></td></tr>
<tr class="memitem:adf1ff8789d836388c4dfc541f1b44f3b inherit pub_methods_classdismec_1_1io_1_1model_1_1PartialModelIO"><td class="memItemLeft" align="right" valign="top">long&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classdismec_1_1io_1_1model_1_1PartialModelIO.html#adf1ff8789d836388c4dfc541f1b44f3b">num_labels</a> () const noexcept</td></tr>
<tr class="memdesc:adf1ff8789d836388c4dfc541f1b44f3b inherit pub_methods_classdismec_1_1io_1_1model_1_1PartialModelIO"><td class="mdescLeft">&#160;</td><td class="mdescRight">Gets the total number of labels.  <a href="classdismec_1_1io_1_1model_1_1PartialModelIO.html#adf1ff8789d836388c4dfc541f1b44f3b">More...</a><br /></td></tr>
<tr class="separator:adf1ff8789d836388c4dfc541f1b44f3b inherit pub_methods_classdismec_1_1io_1_1model_1_1PartialModelIO"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae237aa199cf2114eff1a68aa3268257f inherit pub_methods_classdismec_1_1io_1_1model_1_1PartialModelIO"><td class="memItemLeft" align="right" valign="top">long&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classdismec_1_1io_1_1model_1_1PartialModelIO.html#ae237aa199cf2114eff1a68aa3268257f">num_features</a> () const noexcept</td></tr>
<tr class="memdesc:ae237aa199cf2114eff1a68aa3268257f inherit pub_methods_classdismec_1_1io_1_1model_1_1PartialModelIO"><td class="mdescLeft">&#160;</td><td class="mdescRight">Gets the total number of features.  <a href="classdismec_1_1io_1_1model_1_1PartialModelIO.html#ae237aa199cf2114eff1a68aa3268257f">More...</a><br /></td></tr>
<tr class="separator:ae237aa199cf2114eff1a68aa3268257f inherit pub_methods_classdismec_1_1io_1_1model_1_1PartialModelIO"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="pri-attribs"></a>
Private Attributes</h2></td></tr>
<tr class="memitem:a9638028ccd0f73fc6863d651a91d1c29"><td class="memItemLeft" align="right" valign="top"><a class="el" href="structdismec_1_1io_1_1model_1_1SaveOption.html">SaveOption</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classdismec_1_1io_1_1model_1_1PartialModelSaver.html#a9638028ccd0f73fc6863d651a91d1c29">m_Options</a></td></tr>
<tr class="separator:a9638028ccd0f73fc6863d651a91d1c29"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ab1386580f728eb4ce8642e5bc53aa7e9"><td class="memItemLeft" align="right" valign="top">path&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classdismec_1_1io_1_1model_1_1PartialModelSaver.html#ab1386580f728eb4ce8642e5bc53aa7e9">m_MetaFileName</a></td></tr>
<tr class="separator:ab1386580f728eb4ce8642e5bc53aa7e9"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="inherited"></a>
Additional Inherited Members</h2></td></tr>
<tr class="inherit_header pro_types_classdismec_1_1io_1_1model_1_1PartialModelIO"><td colspan="2" onclick="javascript:toggleInherit('pro_types_classdismec_1_1io_1_1model_1_1PartialModelIO')"><img src="closed.png" alt="-"/>&#160;Protected Types inherited from <a class="el" href="classdismec_1_1io_1_1model_1_1PartialModelIO.html">dismec::io::model::PartialModelIO</a></td></tr>
<tr class="memitem:aa86741204262a3fcb1f14aca1c430fbb inherit pro_types_classdismec_1_1io_1_1model_1_1PartialModelIO"><td class="memItemLeft" align="right" valign="top">using&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classdismec_1_1io_1_1model_1_1PartialModelIO.html#aa86741204262a3fcb1f14aca1c430fbb">weight_file_iter_t</a> = std::vector&lt; <a class="el" href="structdismec_1_1io_1_1model_1_1WeightFileEntry.html">WeightFileEntry</a> &gt;::const_iterator</td></tr>
<tr class="separator:aa86741204262a3fcb1f14aca1c430fbb inherit pro_types_classdismec_1_1io_1_1model_1_1PartialModelIO"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="inherit_header pro_methods_classdismec_1_1io_1_1model_1_1PartialModelIO"><td colspan="2" onclick="javascript:toggleInherit('pro_methods_classdismec_1_1io_1_1model_1_1PartialModelIO')"><img src="closed.png" alt="-"/>&#160;Protected Member Functions inherited from <a class="el" href="classdismec_1_1io_1_1model_1_1PartialModelIO.html">dismec::io::model::PartialModelIO</a></td></tr>
<tr class="memitem:a0d32b86404672ea1921ee39d0bdbed18 inherit pro_methods_classdismec_1_1io_1_1model_1_1PartialModelIO"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classdismec_1_1io_1_1model_1_1PartialModelIO.html#a0d32b86404672ea1921ee39d0bdbed18">PartialModelIO</a> ()=default</td></tr>
<tr class="separator:a0d32b86404672ea1921ee39d0bdbed18 inherit pro_methods_classdismec_1_1io_1_1model_1_1PartialModelIO"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a146cd41309ae9f24e18b81f6d323b512 inherit pro_methods_classdismec_1_1io_1_1model_1_1PartialModelIO"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classdismec_1_1io_1_1model_1_1PartialModelIO.html#a146cd41309ae9f24e18b81f6d323b512">~PartialModelIO</a> ()=default</td></tr>
<tr class="separator:a146cd41309ae9f24e18b81f6d323b512 inherit pro_methods_classdismec_1_1io_1_1model_1_1PartialModelIO"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a1a5062677d465c46092f06da27d618a6 inherit pro_methods_classdismec_1_1io_1_1model_1_1PartialModelIO"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classdismec_1_1io_1_1model_1_1PartialModelIO.html#a1a5062677d465c46092f06da27d618a6">read_metadata_file</a> (const path &amp;meta_file)</td></tr>
<tr class="separator:a1a5062677d465c46092f06da27d618a6 inherit pro_methods_classdismec_1_1io_1_1model_1_1PartialModelIO"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a7df515ff71cf7cb781202cca12c61cde inherit pro_methods_classdismec_1_1io_1_1model_1_1PartialModelIO"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classdismec_1_1io_1_1model_1_1PartialModelIO.html#a7df515ff71cf7cb781202cca12c61cde">insert_sub_file</a> (const <a class="el" href="structdismec_1_1io_1_1model_1_1WeightFileEntry.html">WeightFileEntry</a> &amp;data)</td></tr>
<tr class="memdesc:a7df515ff71cf7cb781202cca12c61cde inherit pro_methods_classdismec_1_1io_1_1model_1_1PartialModelIO"><td class="mdescLeft">&#160;</td><td class="mdescRight">Inserts a new sub-file entry into the metadata object.  <a href="classdismec_1_1io_1_1model_1_1PartialModelIO.html#a7df515ff71cf7cb781202cca12c61cde">More...</a><br /></td></tr>
<tr class="separator:a7df515ff71cf7cb781202cca12c61cde inherit pro_methods_classdismec_1_1io_1_1model_1_1PartialModelIO"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a0589c23b683b3d084a81cc5121a2994f inherit pro_methods_classdismec_1_1io_1_1model_1_1PartialModelIO"><td class="memItemLeft" align="right" valign="top"><a class="el" href="classdismec_1_1io_1_1model_1_1PartialModelIO.html#aa86741204262a3fcb1f14aca1c430fbb">weight_file_iter_t</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classdismec_1_1io_1_1model_1_1PartialModelIO.html#a0589c23b683b3d084a81cc5121a2994f">label_lower_bound</a> (<a class="el" href="classdismec_1_1label__id__t.html">label_id_t</a> pos) const</td></tr>
<tr class="memdesc:a0589c23b683b3d084a81cc5121a2994f inherit pro_methods_classdismec_1_1io_1_1model_1_1PartialModelIO"><td class="mdescLeft">&#160;</td><td class="mdescRight">Gets an iterator into the weight-file list that points to the first element whose starting label is larger than or equal to <code>pos</code>.  <a href="classdismec_1_1io_1_1model_1_1PartialModelIO.html#a0589c23b683b3d084a81cc5121a2994f">More...</a><br /></td></tr>
<tr class="separator:a0589c23b683b3d084a81cc5121a2994f inherit pro_methods_classdismec_1_1io_1_1model_1_1PartialModelIO"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="inherit_header pro_attribs_classdismec_1_1io_1_1model_1_1PartialModelIO"><td colspan="2" onclick="javascript:toggleInherit('pro_attribs_classdismec_1_1io_1_1model_1_1PartialModelIO')"><img src="closed.png" alt="-"/>&#160;Protected Attributes inherited from <a class="el" href="classdismec_1_1io_1_1model_1_1PartialModelIO.html">dismec::io::model::PartialModelIO</a></td></tr>
<tr class="memitem:a09590d987bef63164b61de2a8a407234 inherit pro_attribs_classdismec_1_1io_1_1model_1_1PartialModelIO"><td class="memItemLeft" align="right" valign="top">long&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classdismec_1_1io_1_1model_1_1PartialModelIO.html#a09590d987bef63164b61de2a8a407234">m_TotalLabels</a> = -1</td></tr>
<tr class="separator:a09590d987bef63164b61de2a8a407234 inherit pro_attribs_classdismec_1_1io_1_1model_1_1PartialModelIO"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae69f380355fba9530d157b0969226f21 inherit pro_attribs_classdismec_1_1io_1_1model_1_1PartialModelIO"><td class="memItemLeft" align="right" valign="top">long&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classdismec_1_1io_1_1model_1_1PartialModelIO.html#ae69f380355fba9530d157b0969226f21">m_NumFeatures</a> = -1</td></tr>
<tr class="separator:ae69f380355fba9530d157b0969226f21 inherit pro_attribs_classdismec_1_1io_1_1model_1_1PartialModelIO"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:abdaa8c6e0747a3e5d522d32d8a039700 inherit pro_attribs_classdismec_1_1io_1_1model_1_1PartialModelIO"><td class="memItemLeft" align="right" valign="top">std::vector&lt; <a class="el" href="structdismec_1_1io_1_1model_1_1WeightFileEntry.html">WeightFileEntry</a> &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classdismec_1_1io_1_1model_1_1PartialModelIO.html#abdaa8c6e0747a3e5d522d32d8a039700">m_SubFiles</a></td></tr>
<tr class="separator:abdaa8c6e0747a3e5d522d32d8a039700 inherit pro_attribs_classdismec_1_1io_1_1model_1_1PartialModelIO"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><p>Manage saving a model consisting of multiple partial models. </p>
<p>In large-scale situations, model training will not produce a single, complete model, but instead we will train multiple partial models (either successively, or in a distributed parallel fashion). In that case, the <code>save_model</code> function is not suitable, and this class has to be used.</p>
<p>The work flow looks like this: First, a model saver instance is created. You can pass in the name of the metadata file, and additional options as <a class="el" href="structdismec_1_1io_1_1model_1_1SaveOption.html">SaveOption</a>. </p><div class="fragment"><div class="line">SaveOption options;</div>
<div class="line"><a class="code" href="classdismec_1_1io_1_1model_1_1PartialModelSaver.html#a2756f72407e4d8731fbe758729cc0ddd">PartialModelSaver</a> saver(target_file, options)</div>
<div class="ttc" id="aclassdismec_1_1io_1_1model_1_1PartialModelSaver_html_a2756f72407e4d8731fbe758729cc0ddd"><div class="ttname"><a href="classdismec_1_1io_1_1model_1_1PartialModelSaver.html#a2756f72407e4d8731fbe758729cc0ddd">dismec::io::model::PartialModelSaver::PartialModelSaver</a></div><div class="ttdeci">PartialModelSaver(path target_file, SaveOption options, bool load_partial=false)</div><div class="ttdoc">Create a new PartialModelSaver.</div><div class="ttdef"><b>Definition:</b> <a href="model-io_8cpp_source.html#l00160">model-io.cpp:160</a></div></div>
</div><!-- fragment --><p> Then the partial models will be added. The first model will be used to determine the total number of labels and features, and all further partial models added will be verified to be compatible. Note that <a class="el" href="classdismec_1_1io_1_1model_1_1PartialModelSaver.html#a704d4ae447cb0d7cef57a739bc107711">PartialModelSaver::add_model()</a> does write the weight files, but it does not yet update the metadata file. </p><div class="fragment"><div class="line"><span class="keywordflow">for</span>(<span class="keyword">auto</span>&amp; partial_model : generator_of_partial_models) {</div>
<div class="line">    saver.add_model(partial_model);</div>
<div class="line">}</div>
</div><!-- fragment --><p> After all partial models have been added, you should call <a class="el" href="classdismec_1_1io_1_1model_1_1PartialModelSaver.html#a0a11816ca461bb21679ef21d6d186b85">PartialModelSaver::finalize()</a>. This method first verifies that you have in fact submitted all partial models, i.e. that all together the weight vector for each label has been saved. If that is the case, it updates the metadata file. If you want to checkpoint the models you have saved up to a certain point, but have not yet saved all weights, you can instead use the <a class="el" href="classdismec_1_1io_1_1model_1_1PartialModelSaver.html#abc33455d761a5683ad624a0493b62a96">PartialModelSaver::update_meta_file()</a> function. This will only update the meta-data file, but not check that all weights are present. You can continue writing more partial models to that <a class="el" href="classdismec_1_1io_1_1model_1_1PartialModelSaver.html" title="Manage saving a model consisting of multiple partial models.">PartialModelSaver</a>. Another, typical use case is that you want to continue adding to the save file in another run of the program. In that case, you can load the partial save file by passing true as the <code>load_partial</code> argument to the constructor. </p><div class="fragment"><div class="line">saver.update_meta_file();        <span class="comment">// model is still incomplete</span></div>
<div class="line"><span class="comment">// ...</span></div>
<div class="line"><a class="code" href="classdismec_1_1io_1_1model_1_1PartialModelSaver.html#a2756f72407e4d8731fbe758729cc0ddd">PartialModelSaver</a> continued_save(target_file, options, <span class="keyword">true</span>);    <span class="comment">// load the partial save file</span></div>
<div class="line">continued_save.add_model(missing_parts);                         <span class="comment">// add more partial models</span></div>
<div class="line">continued_save.finalize();                                       <span class="comment">// call finalize once it is complete.</span></div>
<div class="line"><span class="comment">//</span></div>
</div><!-- fragment --> 
<p class="definition">Definition at line <a class="el" href="model-io_8h_source.html#l00236">236</a> of file <a class="el" href="model-io_8h_source.html">model-io.h</a>.</p>
</div><h2 class="groupheader">Constructor &amp; Destructor Documentation</h2>
<a id="a2756f72407e4d8731fbe758729cc0ddd"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a2756f72407e4d8731fbe758729cc0ddd">&#9670;&nbsp;</a></span>PartialModelSaver()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">PartialModelSaver::PartialModelSaver </td>
          <td>(</td>
          <td class="paramtype">path&#160;</td>
          <td class="paramname"><em>target_file</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structdismec_1_1io_1_1model_1_1SaveOption.html">SaveOption</a>&#160;</td>
          <td class="paramname"><em>options</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">bool&#160;</td>
          <td class="paramname"><em>load_partial</em> = <code>false</code>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Create a new <a class="el" href="classdismec_1_1io_1_1model_1_1PartialModelSaver.html" title="Manage saving a model consisting of multiple partial models.">PartialModelSaver</a>. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">target_file</td><td>File name of the metadata file. Also used as the base name for automatically generated weight file name. </td></tr>
    <tr><td class="paramname">options</td><td>Options that will be used for saving the weights of all partial models that will be submitted to <code>add_model</code>. The <a class="el" href="structdismec_1_1io_1_1model_1_1SaveOption.html#af24000aa9e30b519926ec2bf9a38854e">SaveOption::SplitFiles</a> parameter is ignored, though, since file splits are done explicitly through the partial models. </td></tr>
    <tr><td class="paramname">load_partial</td><td>If this is set to true, then it is expected that <code>target_file</code> already exists, and the corresponding metadata will be loaded (but not the weights). This allows to add more weights to an unfinished save file. </td></tr>
  </table>
  </dd>
</dl>
<dl class="section note"><dt>Note</dt><dd>When continuing from an existing checkpoint, we assume that all existing partial weights are valid. If that is not the case, the <code><a class="el" href="classdismec_1_1io_1_1model_1_1PartialModelSaver.html" title="Manage saving a model consisting of multiple partial models.">PartialModelSaver</a></code> will still be able to add more weights (that don't overlap with the existing ones), but actually loading the resulting model file will be impossible. </dd></dl>

<p class="definition">Definition at line <a class="el" href="model-io_8cpp_source.html#l00160">160</a> of file <a class="el" href="model-io_8cpp_source.html">model-io.cpp</a>.</p>

<p class="reference">References <a class="el" href="model-io_8h_source.html#l00309">m_MetaFileName</a>, and <a class="el" href="model-io_8cpp_source.html#l00093">dismec::io::model::PartialModelIO::read_metadata_file()</a>.</p>

</div>
</div>
<h2 class="groupheader">Member Function Documentation</h2>
<a id="a704d4ae447cb0d7cef57a739bc107711"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a704d4ae447cb0d7cef57a739bc107711">&#9670;&nbsp;</a></span>add_model()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">std::future&lt; <a class="el" href="structdismec_1_1io_1_1model_1_1WeightFileEntry.html">WeightFileEntry</a> &gt; PartialModelSaver::add_model </td>
          <td>(</td>
          <td class="paramtype">const std::shared_ptr&lt; const <a class="el" href="classdismec_1_1model_1_1Model.html">Model</a> &gt; &amp;&#160;</td>
          <td class="paramname"><em>model</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const std::optional&lt; std::string &gt; &amp;&#160;</td>
          <td class="paramname"><em>file_path</em> = <code>{}</code>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Adds the weights of a partial model asynchronously. </p>
<p>Saves the weights of <code>model</code> in a weights file and appends that file to the internal list of weight files. This does not update the metadata file. If this method is called for the first time, the total number of labels and features is extracted. All subsequent calls verify that the partial models have the same number of labels and features. This function operates asynchronously, using std::async to launch the actual writing of the weights.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">model</td><td>The model whose weights to save. </td></tr>
    <tr><td class="paramname">file_path</td><td>If given, this will be used as the file path for the weights file. Otherwise, an automatically generated file name is used. </td></tr>
  </table>
  </dd>
</dl>
<dl class="exception"><dt>Exceptions</dt><dd>
  <table class="exception">
    <tr><td class="paramname">std::logic_error</td><td>if <code>model</code> is incompatible because it has a different number of features/labels than the other partial models, or if there is an overlap with already saved weights. </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>A future that becomes ready after the weight file has been written. Its value is the new weight file entry that has been added to the list of weight files. </dd></dl>

<p class="definition">Definition at line <a class="el" href="model-io_8cpp_source.html#l00172">172</a> of file <a class="el" href="model-io_8cpp_source.html">model-io.cpp</a>.</p>

<p class="reference">References <a class="el" href="model-io_8h_source.html#l00174">dismec::io::model::PartialModelIO::m_NumFeatures</a>, and <a class="el" href="model-io_8h_source.html#l00173">dismec::io::model::PartialModelIO::m_TotalLabels</a>.</p>

<p class="reference">Referenced by <a class="el" href="cascade_8cpp_source.html#l00335">TrainingProgram::run()</a>, and <a class="el" href="model-io_8cpp_source.html#l00478">TEST_CASE()</a>.</p>

</div>
</div>
<a id="a5a62294a58a47848a0ad537a6da428e1"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a5a62294a58a47848a0ad537a6da428e1">&#9670;&nbsp;</a></span>any_weight_vector_for_interval()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">bool dismec::io::model::PartialModelSaver::any_weight_vector_for_interval </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="classdismec_1_1label__id__t.html">label_id_t</a>&#160;</td>
          <td class="paramname"><em>begin</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classdismec_1_1label__id__t.html">label_id_t</a>&#160;</td>
          <td class="paramname"><em>end</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td> const</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Checks if there are any weight vectors for the given interval. </p>
<p>This can be used to make sure that training is only run for label ids for which there is no weight vector yet. </p>

<p class="definition">Definition at line <a class="el" href="model-io_8cpp_source.html#l00255">255</a> of file <a class="el" href="model-io_8cpp_source.html">model-io.cpp</a>.</p>

<p class="reference">References <a class="el" href="model-io_8cpp_source.html#l00116">dismec::io::model::PartialModelIO::label_lower_bound()</a>, and <a class="el" href="model-io_8h_source.html#l00176">dismec::io::model::PartialModelIO::m_SubFiles</a>.</p>

<p class="reference">Referenced by <a class="el" href="cascade_8cpp_source.html#l00186">TrainingProgram::parse_label_range()</a>.</p>

</div>
</div>
<a id="a0a11816ca461bb21679ef21d6d186b85"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a0a11816ca461bb21679ef21d6d186b85">&#9670;&nbsp;</a></span>finalize()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void PartialModelSaver::finalize </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Checks that all weights have been written and updates the metadata file. </p>
<p>This function checks that the <code><a class="el" href="classdismec_1_1io_1_1model_1_1PartialModelSaver.html" title="Manage saving a model consisting of multiple partial models.">PartialModelSaver</a></code> has received weight vectors for every label. If that is true, it updates the metadata file. </p><dl class="exception"><dt>Exceptions</dt><dd>
  <table class="exception">
    <tr><td class="paramname">std::logic_error</td><td>If there are missing weight vectors. </td></tr>
  </table>
  </dd>
</dl>
<dl class="todo"><dt><b><a class="el" href="todo.html#_todo000001">Todo:</a></b></dt><dd>Do we need this function? It seems like a nice idea to have a check if everything is done, but currently we don't use it. </dd></dl>

<p class="definition">Definition at line <a class="el" href="model-io_8cpp_source.html#l00277">277</a> of file <a class="el" href="model-io_8cpp_source.html">model-io.cpp</a>.</p>

<p class="reference">References <a class="el" href="model-io_8h_source.html#l00176">dismec::io::model::PartialModelIO::m_SubFiles</a>, <a class="el" href="model-io_8h_source.html#l00173">dismec::io::model::PartialModelIO::m_TotalLabels</a>, and <a class="el" href="model-io_8cpp_source.html#l00234">update_meta_file()</a>.</p>

<p class="reference">Referenced by <a class="el" href="model-io_8cpp_source.html#l00478">TEST_CASE()</a>.</p>

</div>
</div>
<a id="a5c038996f9fa1f9bdb0921a0b79be347"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a5c038996f9fa1f9bdb0921a0b79be347">&#9670;&nbsp;</a></span>get_missing_weights()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">std::pair&lt; <a class="el" href="classdismec_1_1label__id__t.html">label_id_t</a>, <a class="el" href="classdismec_1_1label__id__t.html">label_id_t</a> &gt; PartialModelSaver::get_missing_weights </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Get an interval labels for which weights are missing. </p>
<p>If all weights are present, the returned pair is <code>(num_weights, num_weights)</code>. Otherwise, it is a half-open interval over label ids for which the <code><a class="el" href="classdismec_1_1io_1_1model_1_1PartialModelSaver.html" title="Manage saving a model consisting of multiple partial models.">PartialModelSaver</a></code> doesn't have weights available. </p>

<p class="definition">Definition at line <a class="el" href="model-io_8cpp_source.html#l00292">292</a> of file <a class="el" href="model-io_8cpp_source.html">model-io.cpp</a>.</p>

<p class="reference">References <a class="el" href="model-io_8h_source.html#l00176">dismec::io::model::PartialModelIO::m_SubFiles</a>, and <a class="el" href="model-io_8h_source.html#l00173">dismec::io::model::PartialModelIO::m_TotalLabels</a>.</p>

<p class="reference">Referenced by <a class="el" href="cascade_8cpp_source.html#l00186">TrainingProgram::parse_label_range()</a>.</p>

</div>
</div>
<a id="a7df515ff71cf7cb781202cca12c61cde"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a7df515ff71cf7cb781202cca12c61cde">&#9670;&nbsp;</a></span>insert_sub_file()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void dismec::io::model::PartialModelIO::insert_sub_file</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Inserts a new sub-file entry into the metadata object. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">data</td><td>The specifications of the sub file to be added. </td></tr>
  </table>
  </dd>
</dl>
<dl class="exception"><dt>Exceptions</dt><dd>
  <table class="exception">
    <tr><td class="paramname">std::logic_error</td><td>if <code>data</code> has weights for labels that overlap with already existing weights. </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="model-io_8cpp_source.html#l00184">184</a> of file <a class="el" href="model-io_8cpp_source.html">model-io.cpp</a>.</p>

</div>
</div>
<a id="abc33455d761a5683ad624a0493b62a96"></a>
<h2 class="memtitle"><span class="permalink"><a href="#abc33455d761a5683ad624a0493b62a96">&#9670;&nbsp;</a></span>update_meta_file()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void PartialModelSaver::update_meta_file </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Updates the metadata file. </p>
<p>This ensures that all weight files that have been created due to <code>add_model</code> calls will be listed in the metadata file. Use this function to checkpoint partial saving. If all partial models have been added, call <a class="el" href="classdismec_1_1io_1_1model_1_1PartialModelSaver.html#a0a11816ca461bb21679ef21d6d186b85">finalize()</a> instead, which also verifies the completeness of the data. </p>

<p class="definition">Definition at line <a class="el" href="model-io_8cpp_source.html#l00234">234</a> of file <a class="el" href="model-io_8cpp_source.html">model-io.cpp</a>.</p>

<p class="reference">References <a class="el" href="model-io_8h_source.html#l00309">m_MetaFileName</a>, <a class="el" href="model-io_8h_source.html#l00174">dismec::io::model::PartialModelIO::m_NumFeatures</a>, <a class="el" href="model-io_8h_source.html#l00176">dismec::io::model::PartialModelIO::m_SubFiles</a>, <a class="el" href="model-io_8h_source.html#l00173">dismec::io::model::PartialModelIO::m_TotalLabels</a>, and <a class="el" href="model-io_8cpp_source.html#l00089">dismec::io::model::to_string()</a>.</p>

<p class="reference">Referenced by <a class="el" href="model-io_8cpp_source.html#l00277">finalize()</a>, and <a class="el" href="cascade_8cpp_source.html#l00335">TrainingProgram::run()</a>.</p>

</div>
</div>
<h2 class="groupheader">Member Data Documentation</h2>
<a id="ab1386580f728eb4ce8642e5bc53aa7e9"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ab1386580f728eb4ce8642e5bc53aa7e9">&#9670;&nbsp;</a></span>m_MetaFileName</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">path dismec::io::model::PartialModelSaver::m_MetaFileName</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="model-io_8h_source.html#l00309">309</a> of file <a class="el" href="model-io_8h_source.html">model-io.h</a>.</p>

<p class="reference">Referenced by <a class="el" href="model-io_8cpp_source.html#l00160">PartialModelSaver()</a>, and <a class="el" href="model-io_8cpp_source.html#l00234">update_meta_file()</a>.</p>

</div>
</div>
<a id="a9638028ccd0f73fc6863d651a91d1c29"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a9638028ccd0f73fc6863d651a91d1c29">&#9670;&nbsp;</a></span>m_Options</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="structdismec_1_1io_1_1model_1_1SaveOption.html">SaveOption</a> dismec::io::model::PartialModelSaver::m_Options</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="model-io_8h_source.html#l00308">308</a> of file <a class="el" href="model-io_8h_source.html">model-io.h</a>.</p>

</div>
</div>
<hr/>The documentation for this class was generated from the following files:<ul>
<li>src/io/<a class="el" href="model-io_8h_source.html">model-io.h</a></li>
<li>src/io/<a class="el" href="model-io_8cpp_source.html">model-io.cpp</a></li>
</ul>
</div><!-- contents -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="navelem"><a class="el" href="namespacedismec.html">dismec</a></li><li class="navelem"><a class="el" href="namespacedismec_1_1io.html">io</a></li><li class="navelem"><a class="el" href="namespacedismec_1_1io_1_1model.html">model</a></li><li class="navelem"><a class="el" href="classdismec_1_1io_1_1model_1_1PartialModelSaver.html">PartialModelSaver</a></li>
    <li class="footer">Generated by <a href="https://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.9.1 </li>
  </ul>
</div>
</body>
</html>
