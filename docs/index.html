<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.9.1"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>DiSMEC++: DiSMEC++</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/x-mathjax-config">
  MathJax.Hub.Config({
    extensions: ["tex2jax.js"],
    jax: ["input/TeX","output/HTML-CSS"],
});
</script>
<script type="text/javascript" async="async" src="https://cdn.jsdelivr.net/npm/mathjax@2/MathJax.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">DiSMEC++
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.9.1 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
var searchBox = new SearchBox("searchBox", "search",false,'Search','.html');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */</script>
<div id="main-nav"></div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(document).ready(function(){initNavTree('index.html',''); initResizable(); });
/* @license-end */
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="PageDoc"><div class="header">
  <div class="headertitle">
<div class="title">DiSMEC++ </div>  </div>
</div><!--header-->
<div class="contents">
<div class="textblock"><p><a class="anchor" id="md_README"></a><a href="https://github.com/xmc-aalto/dismecpp/actions/workflows/build.yml"><img src="https://github.com/xmc-aalto/dismecpp/actions/workflows/build.yml/badge.svg" alt="Build" style="pointer-events: none;" class="inline"/></a> <a href="https://github.com/xmc-aalto/dismecpp/actions/workflows/test.yml"><img src="https://github.com/xmc-aalto/dismecpp/actions/workflows/test.yml/badge.svg" alt="Testing" style="pointer-events: none;" class="inline"/></a></p>
<p>A software package for large-scale linear multilabel classification. <code>DiSMEC++</code> is a new implementation of the <a href="https://github.com/xmc-aalto/dismec"><code>DiSMEC</code></a> <a href="#2">[2]</a> algorithm that is better adapted many-core CPUs found in modern cluster environments by taking into account the NUMA setup of these systems, and provides a variety of additional features over the original implementation. Some highlights are:</p><ul>
<li>New weight initialization algorithms for faster training <a href="#3">[3]</a></li>
<li>Ability to read data from and store models as <code>npy</code> files</li>
<li>Ability to handle dense input features</li>
<li>Additional loss functions and regularizers</li>
</ul>
<h1><a class="anchor" id="autotoc_md1"></a>
Usage</h1>
<p>To train a model, the <code>train</code> program can be used, new predictions can be made using the <code>predict</code> executable. Calling these programs with <code>--help</code> as argument will display the list of command-line arguments with a short description.</p>
<h2><a class="anchor" id="autotoc_md2"></a>
Example</h2>
<p>Suppose you want to train a model for the &lt;cite&gt;Eurlex-4k&lt;/cite&gt; <a href="#1">[1]</a> dataset. You can download the data from the <a href="http://manikvarma.org/downloads/XC/XMLRepository.html">extreme classification repository</a>. The two files <code>eurlex_train.txt</code> and <code>eurlex_test.txt</code> are assumed to be in the same directory as the executables, otherwise you need to adjust the paths. You can also use the files included in the <code>test</code> directory in this repository.</p>
<p>A typical training call would look like this: </p><div class="fragment"><div class="line">./train train_eurlex.txt eurlex.model --augment-for-bias --normalize-instances --save-sparse-txt --weight-culling=0.01</div>
</div><!-- fragment --><p> The first positional argument specifies the source for the training data, <code>train_eurlex.txt</code> and the second argument the destination for the result, <code>eurlex.model</code>. Note that models are distributed over several files, with <code>eurlex.model</code> serving as an index file, and the actual weights saved in files that match <code>eurlex.models.weights*</code>.</p>
<p>The next two arguments specify the preprocessing to be applied to the data: <code>--augment-for-bias</code> adds a feature column of ones that serve as a bias term, and <code>--normalize-instances</code> normalizes the features of each instance to have Euclidean norm of 1, which usually improves the results.</p>
<p>The last two arguments specify the saving of the model. The <code>--save-sparse-txt</code> indicates that model weights are saved as human-readable text files of sparse matrices in a <code>index:value</code> format. To ensure model sparsity, <code>--weight-culling=0.01</code> removes all weights with a magnitude of less than <code>0.01</code> from the saved model.</p>
<p>To test the model, you can run </p><div class="fragment"><div class="line">./predict test_eurlex.txt eurlex.model eurlex_pred.txt --augment-for-bias --normalize-instances --topk=5</div>
</div><!-- fragment --><p> Note that the same preprocessing arguments as for the training run need to be specified. This call will determine the top-5 labels for all instances in the test set and write them to the <code>eurlex_pred.txt</code> file. It will also print out a multitude of metrics that can be calculated from these predictions. If you want to further process these metrics, it might be helpful to have them in a format that is easier for scripting. This can be achieved using the argument <code>--save-metrics=eurlex-metrics.json</code>, which will write the metrics to the given json file that can be imported, e.g., into a python script.</p>
<h1><a class="anchor" id="autotoc_md3"></a>
Building</h1>
<p>The code can be build with cmake: </p><div class="fragment"><div class="line">mkdir build</div>
<div class="line">cmake -DCMAKE_BUILD_TYPE=Release -DBUILD_DEVEL_DOCS=Off -S . -B ./build</div>
<div class="line">cmake --build build --parallel</div>
</div><!-- fragment --><p> The resulting executables and python library will be placed in <code>./build/bin</code> and <code>./build/lib</code> respectively.</p>
<p><b>Attention</b> Note that dependencies of the code are included in the <code>deps</code> directory as git submodules. Please ensure that these are properly initialized before building, e.g., by <code>clone</code>ing the repository with the <code>--recurive</code> argument.</p>
<p>Building requires at least GCC8, and we expect <a href="https://www.boost.org/">Boost</a> to be available on the system.</p>
<h1><a class="anchor" id="autotoc_md4"></a>
Documentation</h1>
<p>If you have doxygen installed, then you can build the documentation using <code>cmake --build build --target doxygen</code> and will find the documentation in <code>build/docs/html</code>. You can also browse the documentation <a href="https://xmc-aalto.github.io/dismecpp/index.html">online</a>. If you want the documentation to include internals, you can configure cmake with <code>-DBUILD_DEVEL_DOCS=On</code>.</p>
<h1><a class="anchor" id="autotoc_md5"></a>
Unit Tests</h1>
<p>The unit tests can be built using the <code>unittest</code> cmake target: </p><div class="fragment"><div class="line">cmake --build build --target unittest</div>
</div><!-- fragment --><p> Run the resulting executable <code>bin/unittest</code> to execute the tests and get a report. In addition to unit tests, the github CI also runs the training program on eurlex <a href="#1">[1]</a> data and compares the resulting model with reference weights. As there is no unique, true solution for the learning problem, a failure of this test does not necessarily mean that a code change is breaking things &ndash; but it indicates that the change should be given close attention and additional testing with other datasets, to ensure that there are no regressions. To run these tests manually, use the <code>test/eurlex-test.py</code> script provided in this repository.</p>
<p>The github CI tests ensure that, with <a class="el" href="md_doc_warnings.html">selective warning suppression</a>, the code can be compiled on gcc versions 8 to 12 and clang 10 to 14 with <code>-Wall -Wextra -Werror</code>. Building is tested on Ubuntu versions <code>18.04</code>, <code>20.04</code> and <code>22.04</code>, in both <code>Debug</code> and <code>Release</code> configuration. The current status of the builds (including unit tests) is <a href="https://github.com/xmc-aalto/dismecpp/actions/workflows/build.yml"><img src="https://github.com/xmc-aalto/dismecpp/actions/workflows/build.yml/badge.svg" alt="Build" style="pointer-events: none;" class="inline"/></a>.</p>
<h1><a class="anchor" id="autotoc_md6"></a>
Directories</h1>
<h2><a class="anchor" id="autotoc_md7"></a>
src</h2>
<p>Contains the C++ code for the DiSMEC solver and the python bindings.</p>
<h2><a class="anchor" id="autotoc_md8"></a>
deps</h2>
<p>Contains sources/headers for libraries that we use as part of the implementation, as git submodules. Currently, these are</p><ul>
<li><a href="https://github.com/CLIUtils/CLI11">https://github.com/CLIUtils/CLI11</a></li>
<li><a href="https://github.com/gabime/spdlog">https://github.com/gabime/spdlog</a></li>
<li><a href="https://github.com/onqtam/doctest">https://github.com/onqtam/doctest</a></li>
<li><a href="https://github.com/pybind/pybind11">https://github.com/pybind/pybind11</a></li>
<li><a href="https://github.com/nlohmann/json">https://github.com/nlohmann/json</a></li>
<li><a href="https://gitlab.com/libeigen/eigen">https://gitlab.com/libeigen/eigen</a></li>
</ul>
<h1><a class="anchor" id="autotoc_md9"></a>
References</h1>
<p><a class="anchor" id="1"></a>[1] E. L. Mencia and J. Furnkranz, Efficient pairwise multilabel classification for large-scale problems in the legal domain in ECML/PKDD, 2008.</p>
<p>I. Chalkidis, E. Fergadiotis, P. Malakasiotis, N. Aletras and I. Androutsopoulos, "Extreme Multi-Label Legal Text Classification: A Case Study in EU Legislation", in Natural Legal Language Processing Workshop 2019. <br  />
</p>
<p><a class="anchor" id="2"></a>[2] Rohit Babbar and Bernhard Sch√∂lkopf. "Dismec: Distributed sparse machines for extreme multi-label classification." Proceedings of the tenth ACM international conference on web search and data mining. 2017.</p>
<p><a class="anchor" id="3"></a>[3] Erik Schultheis and Rohit Babbar. "Speeding-up One-vs-All Training for Extreme Classification via Smart Initialization." arXiv preprint arXiv:2109.13122 (2021). </p>
</div></div><!-- PageDoc -->
</div><!-- contents -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="footer">Generated by <a href="https://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.9.1 </li>
  </ul>
</div>
</body>
</html>
